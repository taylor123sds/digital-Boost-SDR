<!DOCTYPE html>
<html>
<head>
  <title>Debug Leads</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    .lead { border: 1px solid #ddd; padding: 10px; margin: 10px 0; border-radius: 5px; }
    .error { color: red; }
    .success { color: green; }
    pre { background: #f4f4f4; padding: 10px; overflow: auto; }
  </style>
</head>
<body>
  <h1>Debug - Sistema de Leads</h1>
  
  <button onclick="testAPI()">Testar API</button>
  <button onclick="testDashboard()">Testar Dashboard</button>
  
  <div id="status"></div>
  <div id="results"></div>

  <script>
    async function testAPI() {
      const status = document.getElementById('status');
      const results = document.getElementById('results');
      
      status.innerHTML = '<p>Testando API...</p>';
      
      try {
        const response = await fetch('/api/leads');
        const data = await response.json();
        
        status.innerHTML = `<p class="success">‚úÖ API funcionando! ${data.items?.length || 0} leads encontrados</p>`;
        
        let html = '<h2>Primeiros 5 leads:</h2>';
        data.items?.slice(0, 5).forEach(lead => {
          html += `
            <div class="lead">
              <strong>${lead.name}</strong><br>
              üì± ${lead.phone || 'Sem telefone'}<br>
              üìß ${lead.email || 'Sem email'}<br>
              üè¢ ${lead.category || 'Sem categoria'}<br>
              üìç ${lead.city || 'Sem cidade'}<br>
              ü§ñ ${lead.ai_opportunity ? lead.ai_opportunity.substring(0, 100) + '...' : 'Sem sugest√£o IA'}
            </div>
          `;
        });
        
        results.innerHTML = html;
        
        console.log('Dados completos:', data);
      } catch (error) {
        status.innerHTML = `<p class="error">‚ùå Erro: ${error.message}</p>`;
        console.error('Erro:', error);
      }
    }
    
    async function testDashboard() {
      const status = document.getElementById('status');
      const results = document.getElementById('results');
      
      status.innerHTML = '<p>Verificando elementos do dashboard...</p>';
      
      // Abrir dashboard em nova aba
      const win = window.open('/dashboard-pro.html', '_blank');
      
      setTimeout(() => {
        status.innerHTML = '<p class="success">Dashboard aberto em nova aba. Verifique o console do navegador.</p>';
        
        results.innerHTML = `
          <h3>Para debugar no dashboard:</h3>
          <ol>
            <li>Abra o Console do navegador (F12)</li>
            <li>Clique na aba "Leads" no menu</li>
            <li>Verifique se aparece: "üìã Carregando dados dos leads..."</li>
            <li>Execute no console: <code>loadLeads()</code></li>
            <li>Execute no console: <code>document.getElementById('leads-table-body').innerHTML</code></li>
          </ol>
          
          <h3>Comandos √∫teis no console:</h3>
          <pre>
// Testar carregamento de leads
loadLeads();

// Ver elemento da tabela
document.getElementById('leads-table-body');

// Testar API diretamente
fetch('/api/leads').then(r => r.json()).then(console.log);

// Ver se a fun√ß√£o existe
typeof loadLeads;

// For√ßar renderiza√ß√£o
fetch('/api/leads')
  .then(r => r.json())
  .then(data => {
    console.log('Leads:', data.items);
    renderLeads(data.items || [], '');
  });
          </pre>
        `;
      }, 1000);
    }
    
    // Teste autom√°tico ao carregar
    testAPI();
  </script>
</body>
</html>