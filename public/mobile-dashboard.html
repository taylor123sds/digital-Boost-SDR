<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>ORBION - Dashboard Mobile</title>
  
  <style>
    /* ===== RESET E BASE ===== */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    :root {
      --primary-color: #667eea;
      --secondary-color: #764ba2;
      --success: #10b981;
      --warning: #f59e0b;
      --error: #ef4444;
      --bg: #f8fafc;
      --card: #ffffff;
      --text: #1e293b;
      --text-muted: #64748b;
      --border: #e2e8f0;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.5;
      overflow-x: hidden;
    }
    
    /* ===== HEADER MOBILE ===== */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 60px;
      background: var(--card);
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 16px;
      z-index: 1000;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    
    .brand {
      font-size: 20px;
      font-weight: 700;
      color: var(--primary-color);
      letter-spacing: -0.5px;
    }
    
    .menu-btn {
      width: 40px;
      height: 40px;
      border: none;
      background: var(--primary-color);
      border-radius: 8px;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .menu-btn:active {
      transform: scale(0.95);
    }
    
    /* ===== BOTTOM NAVIGATION ===== */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 70px;
      background: var(--card);
      border-top: 1px solid var(--border);
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      z-index: 1000;
      box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.1);
    }
    
    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 4px;
      padding: 8px 4px;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
      background: none;
      color: var(--text-muted);
      font-size: 11px;
      font-weight: 500;
    }
    
    .nav-item.active {
      color: var(--primary-color);
      background: linear-gradient(to top, var(--primary-color)10, transparent);
    }
    
    .nav-item:active {
      transform: scale(0.95);
    }
    
    .nav-icon {
      width: 20px;
      height: 20px;
      transition: transform 0.2s ease;
    }
    
    .nav-item.active .nav-icon {
      transform: scale(1.1);
    }
    
    /* ===== DRAWER MENU ===== */
    .drawer-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1500;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .drawer-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    
    .drawer {
      position: fixed;
      top: 0;
      left: -300px;
      width: 300px;
      height: 100vh;
      background: var(--card);
      z-index: 1600;
      transition: left 0.3s ease;
      overflow-y: auto;
      padding: 80px 0 20px 0;
    }
    
    .drawer.active {
      left: 0;
    }
    
    .drawer-item {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 20px 24px;
      cursor: pointer;
      transition: background 0.2s ease;
      border: none;
      background: none;
      width: 100%;
      text-align: left;
      min-height: 56px;
      -webkit-tap-highlight-color: rgba(0, 123, 255, 0.3);
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      user-select: none;
      touch-action: manipulation;
      position: relative;
      font-size: 15px;
      color: var(--text);
    }
    
    .drawer-item:hover, .drawer-item:active {
      background: var(--primary-color)10;
    }
    
    .drawer-item.active {
      background: var(--primary-color)20;
      color: var(--primary-color);
      border-right: 3px solid var(--primary-color);
    }
    
    .drawer-icon {
      width: 22px;
      height: 22px;
      opacity: 0.8;
    }
    
    .drawer-item.active .drawer-icon {
      opacity: 1;
    }
    
    /* ===== MAIN CONTENT ===== */
    .main {
      padding: 80px 16px 90px 16px;
      min-height: 100vh;
    }
    
    .tab {
      display: none;
      animation: fadeIn 0.3s ease;
    }
    
    .tab.active {
      display: block;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* ===== COMPONENTES ===== */
    .card {
      background: var(--card);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 16px;
      border: 1px solid var(--border);
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .card-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 12px;
      color: var(--text);
    }
    
    .stat-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-bottom: 16px;
    }
    
    .stat-card {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      padding: 16px;
      border-radius: 12px;
      text-align: center;
    }
    
    .stat-value {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 4px;
    }
    
    .stat-label {
      font-size: 12px;
      opacity: 0.9;
    }
    
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 20px;
      border: 1px solid var(--border);
      border-radius: 12px;
      background: var(--card);
      color: var(--text);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      text-decoration: none;
      min-height: 48px;
    }
    
    .btn-primary {
      background: var(--primary-color);
      color: white;
      border-color: var(--primary-color);
    }
    
    .btn:active {
      transform: scale(0.98);
    }
    
    .input {
      width: 100%;
      padding: 12px 16px;
      border: 1px solid var(--border);
      border-radius: 12px;
      font-size: 16px;
      background: var(--card);
      color: var(--text);
      transition: border-color 0.2s ease;
      min-height: 48px;
    }
    
    .input:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px var(--primary-color)20;
    }
    
    .list-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid var(--border);
    }
    
    .list-item:last-child {
      border-bottom: none;
    }
    
    /* ===== CHAT MOBILE ===== */
    .chat-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px;
      background: var(--bg-1);
      border-radius: 12px;
      margin-bottom: 16px;
      border: 1px solid var(--border);
    }
    
    .agent-status {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
      color: var(--text);
    }
    
    .status-indicator {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--err);
    }
    
    .status-indicator.active {
      background: var(--ok);
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.6; }
    }
    
    .chat-clear-btn {
      background: none;
      border: 1px solid var(--border);
      color: var(--muted);
      padding: 6px 12px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.2s ease;
    }
    
    .chat-clear-btn:hover {
      background: var(--bg-1);
      color: var(--text);
    }

    .chat-suggestions {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      padding: 12px 16px;
      border-top: 1px solid var(--border);
      background: var(--bg-1);
    }
    
    .suggestion-btn {
      background: var(--bg-0);
      border: 1px solid var(--border);
      color: var(--text);
      padding: 8px 12px;
      border-radius: 20px;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.2s ease;
      white-space: nowrap;
    }
    
    .suggestion-btn:hover {
      background: var(--primary-color);
      color: white;
      border-color: var(--primary-color);
      transform: translateY(-1px);
    }
    
    .chat-container {
      height: 450px;
      border: 1px solid var(--border);
      border-radius: 16px;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      margin-bottom: 16px;
    }
    
    .chat-messages {
      flex: 1;
      padding: 16px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .chat-message {
      max-width: 80%;
      padding: 12px 16px;
      border-radius: 18px;
      font-size: 14px;
      word-wrap: break-word;
    }
    
    .chat-message.user {
      align-self: flex-end;
      background: var(--primary-color);
      color: white;
    }
    
    .chat-message.agent {
      align-self: flex-start;
      background: var(--border);
      color: var(--text);
    }
    
    .chat-input-row {
      display: flex;
      gap: 8px;
      padding: 16px;
      border-top: 1px solid var(--border);
    }
    
    .chat-input-row .input {
      flex: 1;
      margin: 0;
    }
    
    /* ===== WHATSAPP MOBILE ===== */
    .whatsapp-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px;
      background: var(--bg-1);
      border-radius: 12px;
      margin-bottom: 16px;
      border: 1px solid var(--border);
    }
    
    .connection-status {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
    }
    
    .whatsapp-controls {
      padding: 16px;
    }
    
    .input-group {
      margin-bottom: 12px;
    }
    
    .whatsapp-buttons {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    
    .whatsapp-buttons .btn {
      flex: 1;
      min-width: 120px;
    }
    
    .campaign-controls {
      display: flex;
      gap: 8px;
      padding: 16px;
      flex-wrap: wrap;
    }
    
    .campaign-controls .btn {
      flex: 1;
      min-width: 140px;
    }
    
    .contacts-list, .messages-list {
      max-height: 300px;
      overflow-y: auto;
      padding: 16px;
    }
    
    .contact-item, .message-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid var(--border);
    }
    
    .contact-item:last-child, .message-item:last-child {
      border-bottom: none;
    }
    
    .contact-info, .message-info {
      flex: 1;
    }
    
    .contact-name, .message-sender {
      font-weight: 600;
      color: var(--text);
    }
    
    .contact-phone, .message-preview {
      font-size: 12px;
      color: var(--muted);
      margin-top: 2px;
    }
    
    .contact-count, .message-time {
      font-size: 11px;
      color: var(--muted);
      text-align: right;
    }
    
    .loading-state {
      text-align: center;
      padding: 20px;
      color: var(--muted);
    }
    
    /* ===== ANALYTICS MOBILE ===== */
    .analytics-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }
    
    .period-selector {
      padding: 8px 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--bg-0);
      color: var(--text);
      font-size: 12px;
    }
    
    .stat-change {
      font-size: 11px;
      font-weight: 600;
      margin-top: 4px;
    }
    
    .stat-change.positive {
      color: var(--ok);
    }
    
    .stat-change.negative {
      color: var(--err);
    }
    
    .chart-container {
      position: relative;
      padding: 16px;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 200px;
      background: var(--bg-0);
      border-radius: 8px;
      margin: 16px 0;
    }
    
    .channels-grid {
      display: flex;
      flex-direction: column;
      gap: 12px;
      padding: 16px;
    }
    
    .channel-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      background: var(--bg-0);
      border-radius: 8px;
      border: 1px solid var(--border);
    }
    
    .channel-icon {
      font-size: 20px;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-1);
      border-radius: 50%;
    }
    
    .channel-info {
      flex: 1;
    }
    
    .channel-name {
      font-weight: 600;
      color: var(--text);
    }
    
    .channel-count {
      font-size: 12px;
      color: var(--muted);
      margin-top: 2px;
    }
    
    .channel-percentage {
      font-weight: 600;
      color: var(--primary-color);
    }
    
    .goals-grid {
      display: flex;
      flex-direction: column;
      gap: 16px;
      padding: 16px;
    }
    
    .goal-item {
      background: var(--bg-0);
      padding: 16px;
      border-radius: 8px;
      border: 1px solid var(--border);
    }
    
    .goal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    
    .goal-name {
      font-weight: 600;
      color: var(--text);
    }
    
    .goal-target {
      font-size: 12px;
      color: var(--muted);
    }
    
    .progress-bar {
      width: 100%;
      height: 8px;
      background: var(--border);
      border-radius: 4px;
      overflow: hidden;
      margin: 8px 0;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
      transition: width 0.5s ease;
    }
    
    .progress-text {
      font-size: 12px;
      color: var(--muted);
      text-align: center;
    }
    
    /* ===== STATUS/AGENT MONITORING ===== */
    .status-header {
      margin-bottom: 16px;
    }
    
    .main-status-card {
      background: var(--glass);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: relative;
      overflow: hidden;
    }
    
    .main-status-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--ok), var(--primary-color));
      animation: slide 3s linear infinite;
    }
    
    @keyframes slide {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }
    
    .status-indicator-main {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .status-light {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: var(--ok);
    }
    
    .status-light.pulse {
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { 
        box-shadow: 0 0 8px var(--ok);
        transform: scale(1);
      }
      50% { 
        box-shadow: 0 0 16px var(--ok), 0 0 24px var(--ok);
        transform: scale(1.1);
      }
    }
    
    .status-info {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    
    .status-text {
      font-weight: 700;
      font-size: 18px;
      color: var(--ok);
      letter-spacing: 1px;
    }
    
    .uptime-counter {
      font-size: 12px;
      color: var(--muted);
    }
    
    .uptime-percentage {
      text-align: right;
    }
    
    .uptime-percentage span {
      font-weight: 700;
      font-size: 20px;
      color: var(--text);
    }
    
    .uptime-percentage small {
      display: block;
      font-size: 11px;
      color: var(--muted);
    }
    
    .performance-grid {
      display: flex;
      flex-direction: column;
      gap: 16px;
      padding: 16px;
    }
    
    .metric-item {
      background: var(--bg-0);
      padding: 12px;
      border-radius: 8px;
      border: 1px solid var(--border);
    }
    
    .metric-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    
    .metric-name {
      font-weight: 600;
      color: var(--text);
    }
    
    .metric-value {
      font-weight: 700;
      color: var(--primary-color);
    }
    
    .metric-bar {
      width: 100%;
      height: 6px;
      background: var(--border);
      border-radius: 3px;
      overflow: hidden;
    }
    
    .metric-fill {
      height: 100%;
      transition: width 0.8s ease;
      border-radius: 3px;
    }
    
    .cpu-fill {
      background: linear-gradient(90deg, #4ade80, #22c55e);
    }
    
    .memory-fill {
      background: linear-gradient(90deg, #f59e0b, #d97706);
    }
    
    .requests-fill {
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
    }
    
    .services-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
      padding: 16px;
    }
    
    .service-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px;
      background: var(--bg-0);
      border-radius: 8px;
      border: 1px solid var(--border);
    }
    
    .service-info {
      flex: 1;
    }
    
    .service-name {
      font-weight: 600;
      color: var(--text);
      display: block;
    }
    
    .service-detail {
      font-size: 12px;
      color: var(--muted);
      margin-top: 2px;
    }
    
    .service-status {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .service-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--err);
      animation: pulse-dot 2s infinite;
    }
    
    .service-dot.active {
      background: var(--ok);
    }
    
    @keyframes pulse-dot {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.6; }
    }
    
    .logs-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 16px 0 16px;
    }
    
    .logs-container {
      max-height: 300px;
      overflow-y: auto;
      padding: 16px;
      font-family: 'Courier New', monospace;
    }
    
    .log-entry {
      display: flex;
      gap: 8px;
      padding: 4px 8px;
      margin-bottom: 4px;
      font-size: 12px;
      border-radius: 4px;
      animation: fadeInLog 0.5s ease;
      border-left: 2px solid transparent;
    }
    
    .log-entry.success {
      border-left-color: var(--ok);
      background: rgba(34, 197, 94, 0.05);
    }
    
    .log-entry.info {
      border-left-color: var(--primary-color);
      background: rgba(102, 126, 234, 0.05);
    }
    
    .log-entry.warning {
      border-left-color: var(--warn);
      background: rgba(245, 158, 11, 0.05);
    }
    
    .log-entry.error {
      border-left-color: var(--err);
      background: rgba(239, 68, 68, 0.05);
    }
    
    .log-timestamp {
      color: var(--muted);
      min-width: 70px;
    }
    
    .log-message {
      color: var(--text);
      flex: 1;
    }
    
    @keyframes fadeInLog {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    /* ===== CUSTOMIZATION/SETTINGS ===== */
    .customize-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }
    
    .theme-mode-section {
      margin: 20px 0;
      padding: 15px;
      background: var(--custom-bg-1, rgba(255, 255, 255, 0.05));
      border-radius: 12px;
      border: 1px solid var(--custom-border, rgba(255, 255, 255, 0.1));
    }
    
    .current-mode {
      margin-bottom: 15px;
      font-size: 14px;
      color: var(--custom-text-1, #e2e8f0);
    }
    
    .theme-mode-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 10px;
    }
    
    .theme-mode-item {
      position: relative;
    }
    
    .theme-mode-item input[type="radio"] {
      position: absolute;
      opacity: 0;
      pointer-events: none;
    }
    
    .theme-mode-item label {
      display: block;
      padding: 10px 15px;
      background: var(--custom-bg-2, rgba(255, 255, 255, 0.1));
      border: 1px solid var(--custom-border, rgba(255, 255, 255, 0.2));
      border-radius: 8px;
      cursor: pointer;
      text-align: center;
      font-size: 12px;
      transition: all 0.3s ease;
      color: var(--custom-text-2, #cbd5e1);
    }
    
    .theme-mode-item input[type="radio"]:checked + label {
      background: var(--primary-color, #6366f1);
      border-color: var(--primary-color, #6366f1);
      color: white;
      box-shadow: 0 0 10px rgba(99, 102, 241, 0.3);
    }
    
    .theme-mode-item label:hover {
      background: var(--custom-bg-3, rgba(255, 255, 255, 0.15));
      border-color: var(--primary-color, #6366f1);
    }
    
    .theme-controls {
      display: flex;
      flex-direction: column;
      gap: 16px;
      padding: 16px;
    }
    
    .theme-section {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .theme-label {
      font-weight: 600;
      color: var(--text);
      font-size: 14px;
    }
    
    .color-input-group {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    
    .color-input-group input[type="color"] {
      width: 50px;
      height: 40px;
      border: 1px solid var(--border);
      border-radius: 8px;
      cursor: pointer;
      background: none;
    }
    
    .color-text {
      flex: 1;
      padding: 8px 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--bg-0);
      color: var(--text);
      font-family: 'Courier New', monospace;
      font-size: 13px;
    }
    
    .theme-presets {
      margin-top: 20px;
      padding: 16px;
      border-top: 1px solid var(--border);
    }
    
    .preset-label {
      font-weight: 600;
      margin-bottom: 12px;
      color: var(--text);
    }
    
    .presets-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }
    
    .preset-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      padding: 12px;
      background: var(--bg-0);
      border: 1px solid var(--border);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .preset-btn:hover {
      background: var(--bg-1);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .preset-colors {
      display: flex;
      gap: 2px;
    }
    
    .preset-colors div {
      width: 20px;
      height: 20px;
      border-radius: 4px;
    }
    
    .preset-btn span {
      font-size: 12px;
      color: var(--text);
      font-weight: 500;
    }
    
    .theme-preview {
      padding: 16px;
      background: var(--bg-0);
      border-radius: 8px;
      margin: 16px;
    }
    
    .preview-card {
      background: var(--glass);
      border: 1px solid var(--border);
      border-radius: 12px;
      overflow: hidden;
    }
    
    .preview-header {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 16px;
      background: var(--bg-1);
      border-bottom: 1px solid var(--border);
    }
    
    .preview-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--ok);
    }
    
    .preview-content {
      padding: 16px;
    }
    
    .preview-button {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      padding: 8px 16px;
      border-radius: 8px;
      text-align: center;
      font-weight: 600;
      margin-bottom: 12px;
    }
    
    .preview-stats {
      display: flex;
      justify-content: center;
    }
    
    .preview-stat {
      text-align: center;
    }
    
    .preview-value {
      font-size: 20px;
      font-weight: 700;
      color: var(--primary-color);
    }
    
    .preview-label {
      font-size: 12px;
      color: var(--muted);
    }
    
    .settings-list {
      display: flex;
      flex-direction: column;
      gap: 16px;
      padding: 16px;
    }
    
    .setting-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px;
      background: var(--bg-0);
      border-radius: 8px;
      border: 1px solid var(--border);
    }
    
    .setting-info {
      flex: 1;
    }
    
    .setting-name {
      display: block;
      font-weight: 600;
      color: var(--text);
    }
    
    .setting-desc {
      display: block;
      font-size: 12px;
      color: var(--muted);
      margin-top: 2px;
    }
    
    .setting-input {
      padding: 6px 10px;
      border: 1px solid var(--border);
      border-radius: 6px;
      background: var(--bg-0);
      color: var(--text);
      min-width: 80px;
    }
    
    .toggle {
      position: relative;
      display: inline-block;
      width: 44px;
      height: 24px;
    }
    
    .toggle input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    
    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--border);
      transition: 0.3s;
      border-radius: 24px;
    }
    
    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: 0.3s;
      border-radius: 50%;
    }
    
    .toggle input:checked + .toggle-slider {
      background-color: var(--primary-color);
    }
    
    .toggle input:checked + .toggle-slider:before {
      transform: translateX(20px);
    }
    
    .backup-controls {
      display: flex;
      gap: 8px;
      padding: 16px;
      flex-wrap: wrap;
    }
    
    .backup-controls .btn {
      flex: 1;
      min-width: 120px;
    }
    
    .file-input-label {
      position: relative;
      cursor: pointer;
    }
    
    .backup-info {
      padding: 16px;
      background: var(--bg-0);
      border-top: 1px solid var(--border);
      text-align: center;
    }
    
    .backup-info small {
      color: var(--muted);
      line-height: 1.4;
    }
    
    /* ===== CALENDAR MOBILE ===== */
    .calendar-mobile {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .day-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
    }
    
    .day-header {
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 8px;
    }
    
    .event-item {
      background: var(--primary-color)10;
      padding: 8px 12px;
      border-radius: 8px;
      margin-bottom: 8px;
      font-size: 14px;
    }
    
    /* ===== RESPONSIVE UTILITIES ===== */
    .text-center { text-align: center; }
    .text-sm { font-size: 14px; }
    .text-xs { font-size: 12px; }
    .mb-4 { margin-bottom: 16px; }
    .mt-4 { margin-top: 16px; }
    .hidden { display: none !important; }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="brand">ORBION</div>
    <button class="menu-btn" id="menuBtn">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 12h18M3 6h18M3 18h18"/>
      </svg>
    </button>
  </header>

  <!-- Drawer Menu -->
  <div class="drawer-overlay" id="drawerOverlay"></div>
  <div class="drawer" id="drawer">
    <button class="drawer-item active" data-tab="chat">
      <svg class="drawer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
        <path d="M3 6h18v8H8l-5 5V6z"/>
      </svg>
      <span>Conversa</span>
    </button>
    <button class="drawer-item" data-tab="home">
      <svg class="drawer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
        <path d="M3 12l9-9 9 9M4 10v10h6V14h4v6h6V10"/>
      </svg>
      <span>Agendamento</span>
    </button>
    <button class="drawer-item" data-tab="tasks">
      <svg class="drawer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
        <path d="M9 11l3 3L22 4M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
      </svg>
      <span>Tarefas</span>
    </button>
    <button class="drawer-item" data-tab="charts">
      <svg class="drawer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
        <path d="M3 3v18h18M7 13l3 3 7-7"/>
      </svg>
      <span>Gr√°ficos</span>
    </button>
    <button class="drawer-item" data-tab="stats">
      <svg class="drawer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
        <circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/>
      </svg>
      <span>Status do Agente</span>
    </button>
    <button class="drawer-item" data-tab="whatsapp">
      <svg class="drawer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
        <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
        <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
        <path d="m8 12 2 2 4-4"/>
      </svg>
      <span>WhatsApp</span>
    </button>
    <button class="drawer-item" data-tab="leads">
      <svg class="drawer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
        <circle cx="9" cy="7" r="4"/>
        <path d="M23 21v-2a4 4 0 0 0-4-4h-1"/>
        <circle cx="16" cy="3" r="4"/>
      </svg>
      <span>Leads</span>
    </button>
    <button class="drawer-item" data-tab="funnel">
      <svg class="drawer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
        <path d="M3 4h18l-6 10v6h-6v-6l-6-10z"/>
      </svg>
      <span>Funil</span>
    </button>
    <button class="drawer-item" data-tab="customize">
      <svg class="drawer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
        <circle cx="12" cy="12" r="3"/>
        <path d="M12 1v6m0 6v6m12-7h-6m-6 0H1"/>
      </svg>
      <span>Configura√ß√µes</span>
    </button>
  </div>

  <!-- Main Content -->
  <main class="main">
    
    <!-- Chat Tab -->
    <div id="tab-chat" class="tab active">
      <div class="chat-header">
        <div class="agent-status">
          <div class="status-indicator active"></div>
          <span>ORBION IA - Online</span>
        </div>
        <button class="chat-clear-btn" onclick="clearChat()">Limpar</button>
      </div>
      
      <div class="chat-container">
        <div class="chat-messages" id="chat-messages">
          <div class="chat-message agent">
            ü§ñ <strong>Ol√°! Sou o ORBION</strong>, seu assistente IA especializado em vendas e WhatsApp.
            <br><br>
            <strong>Posso ajudar com:</strong><br>
            üì± Gerenciamento de leads<br>
            üìä An√°lise de campanhas<br>
            üéØ Estrat√©gias de vendas<br>
            üìÖ Agendamentos<br>
            <br>
            Como posso ajud√°-lo hoje?
          </div>
        </div>
        <div class="chat-input-row">
          <input type="text" class="input" id="chat-input" placeholder="Digite sobre leads, vendas ou WhatsApp...">
          <button class="btn btn-primary" id="chat-send">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 16px; height: 16px;">
              <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
            </svg>
          </button>
        </div>
        
        <div class="chat-suggestions">
          <button class="suggestion-btn" onclick="sendSuggestion('Como est√£o os leads hoje?')">
            üìä Status dos leads
          </button>
          <button class="suggestion-btn" onclick="sendSuggestion('Mostrar campanhas WhatsApp')">
            üì± Campanhas WhatsApp  
          </button>
          <button class="suggestion-btn" onclick="sendSuggestion('Agendar uma reuni√£o')">
            üìÖ Agendar reuni√£o
          </button>
        </div>
      </div>
      
      <div class="card">
        <div class="card-title">ü§ñ Status do Agente</div>
        <div class="stat-grid">
          <div class="stat-card">
            <div class="stat-value" id="agent-status">Online</div>
            <div class="stat-label">Status</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="response-time">0.8s</div>
            <div class="stat-label">Tempo Resposta</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Home/Agendamento Tab -->
    <div id="tab-home" class="tab">
      <div class="card-title">üè† Agendamento de Eventos</div>
      
      <div class="card">
        <div class="card-title">üìÖ Pr√≥ximos Eventos</div>
        <div class="calendar-mobile" id="calendar-mobile">
          <div class="day-card">
            <div class="day-header">Hoje - Segunda</div>
            <div class="event-item">09:00 - Reuni√£o de vendas</div>
            <div class="event-item">14:00 - Follow-up com leads</div>
          </div>
          <div class="day-card">
            <div class="day-header">Amanh√£ - Ter√ßa</div>
            <div class="event-item">10:00 - Apresenta√ß√£o produto</div>
          </div>
        </div>
      </div>
      
      <div class="card">
        <div class="card-title">‚ûï Novo Evento</div>
        <input type="text" class="input mb-4" placeholder="T√≠tulo do evento">
        <input type="datetime-local" class="input mb-4">
        <button class="btn btn-primary" style="width: 100%;">Criar Evento</button>
      </div>
    </div>

    <!-- Tasks Tab -->
    <div id="tab-tasks" class="tab">
      <div class="card-title">‚úÖ Gerenciamento de Tarefas</div>
      
      <div class="card">
        <div class="card-title">üìã Tarefas Ativas</div>
        <div class="list-item">
          <span>Seguir leads quentes</span>
          <button class="btn text-xs">Concluir</button>
        </div>
        <div class="list-item">
          <span>Atualizar pipeline</span>
          <button class="btn text-xs">Concluir</button>
        </div>
        <div class="list-item">
          <span>Enviar propostas</span>
          <button class="btn text-xs">Concluir</button>
        </div>
      </div>
      
      <div class="card">
        <div class="card-title">‚ûï Nova Tarefa</div>
        <input type="text" class="input mb-4" placeholder="Descri√ß√£o da tarefa">
        <button class="btn btn-primary" style="width: 100%;">Adicionar Tarefa</button>
      </div>
    </div>

    <!-- Charts Tab -->
    <div id="tab-charts" class="tab">
      <div class="analytics-header">
        <div class="card-title">üìä Analytics & Relat√≥rios</div>
        <select class="period-selector" id="analytics-period" onchange="loadAnalyticsData()">
          <option value="7d">√öltimos 7 dias</option>
          <option value="30d" selected>√öltimos 30 dias</option>
          <option value="90d">√öltimos 90 dias</option>
        </select>
      </div>
      
      <div class="stat-grid mb-4">
        <div class="stat-card">
          <div class="stat-value" id="total-leads">-</div>
          <div class="stat-label">Leads Totais</div>
          <div class="stat-change" id="leads-change">-</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="total-conversions">-</div>
          <div class="stat-label">Convers√µes</div>
          <div class="stat-change" id="conversions-change">-</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="conversion-rate">-</div>
          <div class="stat-label">Taxa Convers√£o</div>
          <div class="stat-change" id="rate-change">-</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="revenue">-</div>
          <div class="stat-label">Receita Est.</div>
          <div class="stat-change" id="revenue-change">-</div>
        </div>
      </div>
      
      <div class="card mb-4">
        <div class="card-title">üìà Performance Mensal</div>
        <div class="chart-container">
          <canvas id="performance-chart" width="300" height="200"></canvas>
        </div>
      </div>
      
      <div class="card mb-4">
        <div class="card-title">üì± Canais de Contato</div>
        <div class="channels-grid">
          <div class="channel-item">
            <div class="channel-icon">üì±</div>
            <div class="channel-info">
              <div class="channel-name">WhatsApp</div>
              <div class="channel-count" id="whatsapp-messages">-</div>
            </div>
            <div class="channel-percentage" id="whatsapp-percentage">-%</div>
          </div>
          <div class="channel-item">
            <div class="channel-icon">üìß</div>
            <div class="channel-info">
              <div class="channel-name">Email</div>
              <div class="channel-count" id="email-messages">-</div>
            </div>
            <div class="channel-percentage" id="email-percentage">-%</div>
          </div>
          <div class="channel-item">
            <div class="channel-icon">üìû</div>
            <div class="channel-info">
              <div class="channel-name">Chamadas</div>
              <div class="channel-count" id="call-messages">-</div>
            </div>
            <div class="channel-percentage" id="call-percentage">-%</div>
          </div>
        </div>
      </div>
      
      <div class="card">
        <div class="card-title">üéØ Metas vs Resultados</div>
        <div class="goals-grid">
          <div class="goal-item">
            <div class="goal-header">
              <span class="goal-name">Leads M√™s</span>
              <span class="goal-target">Meta: 200</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="leads-progress" style="width: 0%"></div>
            </div>
            <div class="progress-text"><span id="leads-achieved">0</span> / 200</div>
          </div>
          
          <div class="goal-item">
            <div class="goal-header">
              <span class="goal-name">Convers√µes</span>
              <span class="goal-target">Meta: 50</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="conversions-progress" style="width: 0%"></div>
            </div>
            <div class="progress-text"><span id="conversions-achieved">0</span> / 50</div>
          </div>
          
          <div class="goal-item">
            <div class="goal-header">
              <span class="goal-name">Receita</span>
              <span class="goal-target">Meta: R$ 50k</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="revenue-progress" style="width: 0%"></div>
            </div>
            <div class="progress-text">R$ <span id="revenue-achieved">0</span> / 50k</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Stats Tab -->
    <div id="tab-stats" class="tab">
      <!-- Main Status Header -->
      <div class="status-header">
        <div class="main-status-card">
          <div class="status-indicator-main">
            <div class="status-light pulse" id="main-status-light"></div>
            <div class="status-info">
              <div class="status-text" id="main-status-text">ONLINE</div>
              <div class="uptime-counter" id="uptime-counter">Calculando...</div>
            </div>
          </div>
          <div class="uptime-percentage">
            <span id="uptime-percentage">99.9%</span>
            <small>Disponibilidade</small>
          </div>
        </div>
      </div>
      
      <!-- Performance Metrics -->
      <div class="card mb-4">
        <div class="card-title">‚ö° Performance do Sistema</div>
        <div class="performance-grid">
          <div class="metric-item">
            <div class="metric-header">
              <span class="metric-name">CPU</span>
              <span class="metric-value" id="cpu-value">0%</span>
            </div>
            <div class="metric-bar">
              <div class="metric-fill cpu-fill" id="cpu-fill"></div>
            </div>
          </div>
          
          <div class="metric-item">
            <div class="metric-header">
              <span class="metric-name">Mem√≥ria</span>
              <span class="metric-value" id="memory-value">0%</span>
            </div>
            <div class="metric-bar">
              <div class="metric-fill memory-fill" id="memory-fill"></div>
            </div>
          </div>
          
          <div class="metric-item">
            <div class="metric-header">
              <span class="metric-name">Req/min</span>
              <span class="metric-value" id="requests-value">0</span>
            </div>
            <div class="metric-bar">
              <div class="metric-fill requests-fill" id="requests-fill"></div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Services Status -->
      <div class="card mb-4">
        <div class="card-title">üîß Status dos Servi√ßos</div>
        <div class="services-list">
          <div class="service-item">
            <div class="service-info">
              <span class="service-name">API Principal</span>
              <span class="service-detail">Processando requisi√ß√µes</span>
            </div>
            <div class="service-status">
              <div class="service-dot active" id="api-status"></div>
              <span id="api-text">Ativo</span>
            </div>
          </div>
          
          <div class="service-item">
            <div class="service-info">
              <span class="service-name">WhatsApp</span>
              <span class="service-detail">Evolution API</span>
            </div>
            <div class="service-status">
              <div class="service-dot" id="whatsapp-service-status"></div>
              <span id="whatsapp-service-text">Verificando...</span>
            </div>
          </div>
          
          <div class="service-item">
            <div class="service-info">
              <span class="service-name">Banco de Dados</span>
              <span class="service-detail">SQLite Local</span>
            </div>
            <div class="service-status">
              <div class="service-dot active" id="db-status"></div>
              <span id="db-text">Operacional</span>
            </div>
          </div>
          
          <div class="service-item">
            <div class="service-info">
              <span class="service-name">OpenAI API</span>
              <span class="service-detail">GPT-4 Turbo</span>
            </div>
            <div class="service-status">
              <div class="service-dot active" id="openai-status"></div>
              <span id="openai-text">Conectado</span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Activity Chart -->
      <div class="card mb-4">
        <div class="card-title">üìä Atividade em Tempo Real</div>
        <div class="chart-container">
          <canvas id="activity-chart" width="300" height="150"></canvas>
        </div>
      </div>
      
      <!-- Statistics -->
      <div class="stats-grid mb-4">
        <div class="stat-card">
          <div class="stat-value" id="messages-processed">0</div>
          <div class="stat-label">Mensagens Processadas</div>
          <div class="stat-change positive" id="messages-change">+0</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="response-time">0ms</div>
          <div class="stat-label">Tempo de Resposta</div>
          <div class="stat-change positive" id="response-change">-0ms</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="active-users">0</div>
          <div class="stat-label">Usu√°rios Ativos</div>
          <div class="stat-change" id="users-change">Online</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="errors-24h">0</div>
          <div class="stat-label">Erros (24h)</div>
          <div class="stat-change positive">Sistema Est√°vel</div>
        </div>
      </div>
      
      <!-- System Logs -->
      <div class="card">
        <div class="logs-header">
          <div class="card-title">üìù Logs do Sistema</div>
          <button class="btn btn-small" onclick="clearLogs()">Limpar</button>
        </div>
        <div class="logs-container" id="system-logs">
          <div class="loading-state">Carregando logs...</div>
        </div>
        </div>
        <div class="list-item">
          <span>Connections</span>
          <span style="color: var(--success);">142</span>
        </div>
        <div class="list-item">
          <span>Uptime</span>
          <span>12d 4h 23m</span>
        </div>
      </div>
    </div>

    <!-- WhatsApp Tab -->
    <div id="tab-whatsapp" class="tab">
      <div class="whatsapp-header">
        <div class="connection-status">
          <div class="status-indicator" id="whatsapp-status"></div>
          <span id="whatsapp-status-text">Verificando conex√£o...</span>
        </div>
        <button class="btn btn-small" onclick="refreshWhatsAppData()">Atualizar</button>
      </div>
      
      <div class="stat-grid mb-4">
        <div class="stat-card">
          <div class="stat-value" id="messages-today">-</div>
          <div class="stat-label">Mensagens Hoje</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="active-contacts">-</div>
          <div class="stat-label">Contatos Ativos</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="response-rate">-</div>
          <div class="stat-label">Taxa de Resposta</div>
        </div>
      </div>
      
      <div class="card mb-4">
        <div class="card-title">üì§ Enviar Mensagem</div>
        <div class="whatsapp-controls">
          <div class="input-group mb-3">
            <input type="text" class="input" id="whatsapp-phone" placeholder="N√∫mero (ex: 5511999999999)">
          </div>
          <div class="input-group mb-3">
            <textarea class="input" id="whatsapp-message" placeholder="Digite sua mensagem..." rows="3"></textarea>
          </div>
          <div class="whatsapp-buttons">
            <button class="btn btn-primary" onclick="sendWhatsAppMessage()">
              üì± Enviar Texto
            </button>
            <button class="btn btn-secondary" onclick="sendWhatsAppTTS()">
              üéµ Enviar √Åudio (TTS)
            </button>
          </div>
        </div>
      </div>
      
      <div class="card mb-4">
        <div class="card-title">üöÄ Campanhas</div>
        <div class="campaign-controls">
          <button class="btn btn-primary" onclick="runIntelligentCampaign()">
            üß† Campanha Inteligente
          </button>
          <button class="btn btn-secondary" onclick="callRandomLead()">
            üìû Ligar para Lead Aleat√≥rio
          </button>
        </div>
      </div>
      
      <div class="card">
        <div class="card-title">üí¨ Contatos Principais</div>
        <div id="whatsapp-contacts" class="contacts-list">
          <div class="loading-state">Carregando contatos...</div>
        </div>
      </div>
      
      <div class="card">
        <div class="card-title">üìã Mensagens Recentes</div>
        <div id="whatsapp-messages" class="messages-list">
          <div class="text-xs text-muted">15:30</div>
        </div>
        <div class="list-item">
          <div>
            <div style="font-weight: 600;">Maria Costa</div>
            <div class="text-sm text-muted">Quando posso agendar?</div>
          </div>
          <div class="text-xs text-muted">14:45</div>
        </div>
      </div>
    </div>

    <!-- Leads Tab -->
    <div id="tab-leads" class="tab">
      <div class="card-title">üë• Gest√£o de Leads</div>
      
      <div class="stat-grid mb-4">
        <div class="stat-card">
          <div class="stat-value">45</div>
          <div class="stat-label">Leads Novos</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">23</div>
          <div class="stat-label">Em Follow-up</div>
        </div>
      </div>
      
      <div class="card">
        <div class="card-title">üî• Leads Quentes</div>
        <div class="list-item">
          <div>
            <div style="font-weight: 600;">Carlos Mendes</div>
            <div class="text-sm text-muted">carlos@empresa.com</div>
          </div>
          <button class="btn text-xs btn-primary">Contatar</button>
        </div>
        <div class="list-item">
          <div>
            <div style="font-weight: 600;">Ana Paula</div>
            <div class="text-sm text-muted">ana@startup.com</div>
          </div>
          <button class="btn text-xs btn-primary">Contatar</button>
        </div>
      </div>
    </div>

    <!-- Funnel Tab -->
    <div id="tab-funnel" class="tab">
      <div class="card-title">üìà Funil de Vendas</div>
      
      <div class="card">
        <div class="card-title">üéØ Pipeline</div>
        <div class="list-item">
          <span>Prospec√ß√£o</span>
          <span style="color: var(--primary-color); font-weight: 600;">67 leads</span>
        </div>
        <div class="list-item">
          <span>Qualifica√ß√£o</span>
          <span style="color: var(--warning); font-weight: 600;">34 leads</span>
        </div>
        <div class="list-item">
          <span>Proposta</span>
          <span style="color: var(--success); font-weight: 600;">12 leads</span>
        </div>
        <div class="list-item">
          <span>Fechamento</span>
          <span style="color: var(--success); font-weight: 600;">5 leads</span>
        </div>
      </div>
    </div>

    <!-- Customize Tab -->
    <div id="tab-customize" class="tab">
      <div class="customize-header">
        <div class="card-title">‚öôÔ∏è Configura√ß√µes do Sistema</div>
        <button class="btn btn-small" onclick="resetToDefaults()">Padr√µes</button>
      </div>
      
      <!-- Theme Mode Selection -->
      <div class="card mb-4">
        <div class="card-title">üåô Modo do Tema</div>
        <div class="theme-mode-section">
          <div class="current-mode">
            <span>Modo Atual: </span><strong id="current-theme-mode">‚òÄÔ∏è Claro</strong>
          </div>
          <div class="theme-mode-grid">
            <div class="theme-mode-item">
              <input type="radio" name="theme-mode" value="light" id="mode-light" onchange="switchThemeMode('light')">
              <label for="mode-light">‚òÄÔ∏è Claro</label>
            </div>
            <div class="theme-mode-item">
              <input type="radio" name="theme-mode" value="dark" id="mode-dark" onchange="switchThemeMode('dark')">
              <label for="mode-dark">üåô Escuro</label>
            </div>
            <div class="theme-mode-item">
              <input type="radio" name="theme-mode" value="glass" id="mode-glass" onchange="switchThemeMode('glass')">
              <label for="mode-glass">üíé Glass</label>
            </div>
            <div class="theme-mode-item">
              <input type="radio" name="theme-mode" value="neon" id="mode-neon" onchange="switchThemeMode('neon')">
              <label for="mode-neon">‚ö° Neon</label>
            </div>
            <div class="theme-mode-item">
              <input type="radio" name="theme-mode" value="minimal" id="mode-minimal" onchange="switchThemeMode('minimal')">
              <label for="mode-minimal">‚ö™ Minimal</label>
            </div>
            <div class="theme-mode-item">
              <input type="radio" name="theme-mode" value="contrast" id="mode-contrast" onchange="switchThemeMode('contrast')">
              <label for="mode-contrast">‚ö´ Alto Contraste</label>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Theme Customization -->
      <div class="card mb-4">
        <div class="card-title">üé® Personaliza√ß√£o de Tema</div>
        <div class="theme-controls">
          <div class="theme-section">
            <label class="theme-label">Cor Prim√°ria</label>
            <div class="color-input-group">
              <input type="color" id="primary-color" value="#667eea" onchange="updateTheme()" oninput="updateTheme()">
              <input type="text" class="color-text" id="primary-text" value="#667eea" onchange="updateThemeFromText()" oninput="updateThemeFromText()">
            </div>
          </div>
          
          <div class="theme-section">
            <label class="theme-label">Cor Secund√°ria</label>
            <div class="color-input-group">
              <input type="color" id="secondary-color" value="#764ba2" onchange="updateTheme()" oninput="updateTheme()">
              <input type="text" class="color-text" id="secondary-text" value="#764ba2" onchange="updateThemeFromText()" oninput="updateThemeFromText()">
            </div>
          </div>
          
          <div class="theme-section">
            <label class="theme-label">Cor de Destaque</label>
            <div class="color-input-group">
              <input type="color" id="accent-color" value="#4facfe" onchange="updateTheme()" oninput="updateTheme()">
              <input type="text" class="color-text" id="accent-text" value="#4facfe" onchange="updateThemeFromText()" oninput="updateThemeFromText()">
            </div>
          </div>
        </div>
        
        <div class="theme-presets">
          <div class="preset-label">Temas Predefinidos:</div>
          <div class="presets-grid">
            <button class="preset-btn" onclick="applyPreset('default')">
              <div class="preset-colors">
                <div style="background: #667eea;"></div>
                <div style="background: #764ba2;"></div>
                <div style="background: #4facfe;"></div>
              </div>
              <span>Padr√£o</span>
            </button>
            
            <button class="preset-btn" onclick="applyPreset('ocean')">
              <div class="preset-colors">
                <div style="background: #0891b2;"></div>
                <div style="background: #0e7490;"></div>
                <div style="background: #06b6d4;"></div>
              </div>
              <span>Oceano</span>
            </button>
            
            <button class="preset-btn" onclick="applyPreset('forest')">
              <div class="preset-colors">
                <div style="background: #059669;"></div>
                <div style="background: #047857;"></div>
                <div style="background: #10b981;"></div>
              </div>
              <span>Floresta</span>
            </button>
            
            <button class="preset-btn" onclick="applyPreset('sunset')">
              <div class="preset-colors">
                <div style="background: #ea580c;"></div>
                <div style="background: #dc2626;"></div>
                <div style="background: #f97316;"></div>
              </div>
              <span>P√¥r do Sol</span>
            </button>
            
            <button class="preset-btn" onclick="applyPreset('purple')">
              <div class="preset-colors">
                <div style="background: #7c3aed;"></div>
                <div style="background: #5b21b6;"></div>
                <div style="background: #8b5cf6;"></div>
              </div>
              <span>Roxo</span>
            </button>
            
            <button class="preset-btn" onclick="applyPreset('dark')">
              <div class="preset-colors">
                <div style="background: #374151;"></div>
                <div style="background: #1f2937;"></div>
                <div style="background: #6b7280;"></div>
              </div>
              <span>Escuro</span>
            </button>
          </div>
        </div>
      </div>
      
      <!-- Theme Preview -->
      <div class="card mb-4">
        <div class="card-title">üëÄ Pr√©-visualiza√ß√£o</div>
        <div class="theme-preview">
          <div class="preview-card">
            <div class="preview-header">
              <div class="preview-dot active"></div>
              <span>Exemplo de Card</span>
            </div>
            <div class="preview-content">
              <div class="preview-button">Bot√£o Prim√°rio</div>
              <div class="preview-stats">
                <div class="preview-stat">
                  <div class="preview-value">42</div>
                  <div class="preview-label">Metric</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Advanced Settings -->
      <div class="card mb-4">
        <div class="card-title">üîß Configura√ß√µes Avan√ßadas</div>
        <div class="settings-list">
          <div class="setting-item">
            <div class="setting-info">
              <span class="setting-name">Nome da Empresa</span>
              <span class="setting-desc">Nome exibido no dashboard</span>
            </div>
            <input type="text" class="setting-input" id="company-name" value="ORBION" onchange="updateCompanyName()">
          </div>
          
          <div class="setting-item">
            <div class="setting-info">
              <span class="setting-name">Auto-atualiza√ß√£o</span>
              <span class="setting-desc">Atualizar dados automaticamente</span>
            </div>
            <label class="toggle">
              <input type="checkbox" id="auto-refresh" checked onchange="toggleAutoRefresh()">
              <span class="toggle-slider"></span>
            </label>
          </div>
          
          <div class="setting-item">
            <div class="setting-info">
              <span class="setting-name">Anima√ß√µes</span>
              <span class="setting-desc">Ativar anima√ß√µes e transi√ß√µes</span>
            </div>
            <label class="toggle">
              <input type="checkbox" id="animations" checked onchange="toggleAnimations()">
              <span class="toggle-slider"></span>
            </label>
          </div>
          
          <div class="setting-item">
            <div class="setting-info">
              <span class="setting-name">Notifica√ß√µes sonoras</span>
              <span class="setting-desc">Sons para alertas</span>
            </div>
            <label class="toggle">
              <input type="checkbox" id="sound-alerts" onchange="toggleSoundAlerts()">
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
      </div>
      
      <!-- Export/Import -->
      <div class="card">
        <div class="card-title">üíæ Backup & Configura√ß√µes</div>
        <div class="backup-controls">
          <button class="btn btn-primary" onclick="exportSettings()">
            üì§ Exportar Configura√ß√µes
          </button>
          <label class="btn btn-secondary file-input-label">
            üì• Importar Configura√ß√µes
            <input type="file" id="import-settings" accept=".json" onchange="importSettings()" style="display: none;">
          </label>
        </div>
        
        <div class="backup-info">
          <small>
            √öltima atualiza√ß√£o: <span id="last-updated">Agora</span><br>
            Configura√ß√µes salvas automaticamente
          </small>
        </div>
        
        <div class="theme-test" style="margin-top: 16px; padding: 16px; border-top: 1px solid var(--border);">
          <button class="btn btn-primary" onclick="testThemeColors()" style="width: 100%; margin-bottom: 8px;">
            üß™ Testar Cores do Tema
          </button>
          <div id="theme-test-result" style="font-size: 12px; color: var(--muted); text-align: center;">
            Clique para testar se as cores est√£o sendo aplicadas
          </div>
        </div>
          <span>Tema Escuro</span>
          <button class="btn text-xs">Ativar</button>
        </div>
        <div class="list-item">
          <span>Notifica√ß√µes</span>
          <button class="btn text-xs btn-primary">Ligado</button>
        </div>
        <div class="list-item">
          <span>Som</span>
          <button class="btn text-xs btn-primary">Ligado</button>
        </div>
      </div>
      
      <div class="card">
        <div class="card-title">üîß Sistema</div>
        <button class="btn mb-4" style="width: 100%;">Limpar Cache</button>
        <button class="btn mb-4" style="width: 100%;">Exportar Dados</button>
        <button class="btn" style="width: 100%; color: var(--error);">Reset Configura√ß√µes</button>
      </div>
    </div>

  </main>

  <!-- Bottom Navigation -->
  <nav class="bottom-nav">
    <button class="nav-item active" data-tab="chat">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
      </svg>
      Chat
    </button>
    <button class="nav-item" data-tab="home">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 12l9-9 9 9M4 10v10h6V14h4v6h6V10"/>
      </svg>
      Home
    </button>
    <button class="nav-item" data-tab="leads">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
        <circle cx="9" cy="7" r="4"/>
      </svg>
      Leads
    </button>
    <button class="nav-item" data-tab="stats">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 3v18h18M7 13l3 3 7-7"/>
      </svg>
      Stats
    </button>
  </nav>

  <script>
    console.log('üöÄ MOBILE NAVIGATION - VERS√ÉO ULTRA CORRIGIDA');
    
    // Aguardar DOM carregar completamente
    document.addEventListener('DOMContentLoaded', function() {
      console.log('üì± DOM READY - Iniciando sistema mobile...');
      
      // ===== BUSCAR ELEMENTOS =====
      const menuBtn = document.getElementById('menuBtn');
      const drawer = document.getElementById('drawer');
      const drawerOverlay = document.getElementById('drawerOverlay');
      
      console.log('üîç Elementos principais:');
      console.log('- Menu Button:', !!menuBtn, menuBtn);
      console.log('- Drawer:', !!drawer, drawer);
      console.log('- Overlay:', !!drawerOverlay, drawerOverlay);
      
      // Verificar se elementos existem
      if (!menuBtn || !drawer || !drawerOverlay) {
        console.error('‚ùå ERRO CR√çTICO: Elementos principais n√£o encontrados!');
        return;
      }
      
      // Buscar itens ap√≥s DOM carregar
      const drawerItems = document.querySelectorAll('.drawer-item');
      const navItems = document.querySelectorAll('.nav-item'); 
      const tabs = document.querySelectorAll('.tab');
      
      console.log('üìä Navega√ß√£o:');
      console.log('- Drawer Items:', drawerItems.length);
      console.log('- Nav Items:', navItems.length);
      console.log('- Tabs:', tabs.length);
      
      // Listar todas as abas dispon√≠veis
      console.log('üìã Abas encontradas:');
      tabs.forEach((tab, i) => {
        console.log(`  ${i + 1}. ${tab.id}`);
      });
      
      // ===== FUN√á√ïES DE NAVEGA√á√ÉO =====
      
      // Alternar drawer (abrir/fechar)
      function toggleDrawer(e) {
        if (e) {
          e.preventDefault();
          e.stopPropagation();
        }
        
        console.log('üîÑ TOGGLE DRAWER');
        const isOpen = drawer.classList.contains('active');
        
        if (isOpen) {
          drawer.classList.remove('active');
          drawerOverlay.classList.remove('active');
          console.log('üì¥ Drawer FECHADO');
        } else {
          drawer.classList.add('active'); 
          drawerOverlay.classList.add('active');
          console.log('üì± Drawer ABERTO');
        }
      }
      
      // Navegar para aba espec√≠fica
      function navigateToTab(tabName) {
        console.log('üéØ NAVEGANDO PARA:', tabName);
        
        if (!tabName) {
          console.error('‚ùå Nome da aba inv√°lido!');
          return false;
        }
        
        // Desativar todas as abas
        let tabsHidden = 0;
        tabs.forEach(tab => {
          if (tab.classList.contains('active')) {
            tab.classList.remove('active');
            tabsHidden++;
          }
        });
        console.log(`üìã ${tabsHidden} aba(s) desativada(s)`);
        
        // Ativar aba alvo
        const targetTab = document.getElementById('tab-' + tabName);
        if (targetTab) {
          targetTab.classList.add('active');
          console.log('‚úÖ ABA ATIVADA:', tabName);
        } else {
          console.error('‚ùå ABA N√ÉO ENCONTRADA:', 'tab-' + tabName);
          console.log('üìÑ Abas dispon√≠veis:');
          tabs.forEach(tab => console.log('  -', tab.id));
          return false;
        }
        
        // Atualizar visual dos drawer items
        drawerItems.forEach(item => {
          item.classList.remove('active');
          if (item.getAttribute('data-tab') === tabName) {
            item.classList.add('active');
          }
        });
        
        // Atualizar visual dos nav items
        navItems.forEach(item => {
          item.classList.remove('active');
          if (item.getAttribute('data-tab') === tabName) {
            item.classList.add('active');
          }
        });
        
        // Fechar drawer
        drawer.classList.remove('active');
        drawerOverlay.classList.remove('active');
        console.log('üì¥ Drawer fechado');
        
        console.log('üéâ NAVEGA√á√ÉO COMPLETA!');
        return true;
      }
      
      // ===== EVENT LISTENERS =====
      
      console.log('üîó Configurando event listeners...');
      
      // Hamburger menu
      if (menuBtn) {
        menuBtn.addEventListener('click', function(e) {
          console.log('üçî HAMBURGER CLICADO!');
          toggleDrawer(e);
        });
        
        menuBtn.addEventListener('touchend', function(e) {
          console.log('üëÜ HAMBURGER TOUCH!');
          e.preventDefault();
          setTimeout(() => toggleDrawer(e), 50);
        });
        
        console.log('‚úÖ Hamburger configurado');
      }
      
      // Overlay
      if (drawerOverlay) {
        drawerOverlay.addEventListener('click', function(e) {
          console.log('üì± OVERLAY CLICADO!');
          toggleDrawer(e);
        });
        
        console.log('‚úÖ Overlay configurado');
      }
      
      // Drawer items (navega√ß√£o lateral)
      console.log('üîó Configurando drawer items...');
      drawerItems.forEach((item, index) => {
        const tabName = item.getAttribute('data-tab');
        console.log(`  ${index + 1}. Configurando: ${tabName}`);
        
        if (!tabName) {
          console.warn('‚ö†Ô∏è Item sem data-tab:', item);
          return;
        }
        
        // Click event
        item.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          console.log('üî• DRAWER CLIQUE:', tabName);
          navigateToTab(tabName);
        });
        
        // Touch events para mobile
        item.addEventListener('touchstart', function(e) {
          console.log('üëÜ TOUCH START:', tabName);
          item.style.backgroundColor = 'rgba(0, 123, 255, 0.1)';
        });
        
        item.addEventListener('touchend', function(e) {
          console.log('üëÜ TOUCH END:', tabName);
          item.style.backgroundColor = '';
          e.preventDefault();
          
          // Delay para garantir processamento
          setTimeout(() => {
            console.log('‚è∞ Executando navega√ß√£o ap√≥s delay:', tabName);
            navigateToTab(tabName);
          }, 100);
        });
        
        // Mouse events para hover
        item.addEventListener('mousedown', function() {
          item.style.backgroundColor = 'rgba(0, 123, 255, 0.1)';
        });
        
        item.addEventListener('mouseup', function() {
          item.style.backgroundColor = '';
        });
        
        item.addEventListener('mouseleave', function() {
          item.style.backgroundColor = '';
        });
      });
      
      // Bottom navigation
      console.log('üîó Configurando bottom nav...');
      navItems.forEach((item, index) => {
        const tabName = item.getAttribute('data-tab');
        console.log(`  ${index + 1}. Nav: ${tabName}`);
        
        if (!tabName) return;
        
        item.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          console.log('üî• BOTTOM NAV CLIQUE:', tabName);
          navigateToTab(tabName);
        });
      });
      
      // ===== CHAT FUNCTIONALITY =====
      
      const chatInput = document.getElementById('chat-input');
      const chatSend = document.getElementById('chat-send');
      const chatMessages = document.getElementById('chat-messages');
      
      // Chat functionality with real API integration
      async function sendMessage() {
        const message = chatInput?.value?.trim();
        if (!message || !chatMessages) return;
        
        console.log('üí¨ Enviando mensagem:', message);
        
        // Add user message
        const userMsg = document.createElement('div');
        userMsg.className = 'chat-message user';
        userMsg.textContent = message;
        chatMessages.appendChild(userMsg);
        
        // Clear input
        if (chatInput) chatInput.value = '';
        chatMessages.scrollTop = chatMessages.scrollHeight;
        
        // Show loading message
        const loadingMsg = document.createElement('div');
        loadingMsg.className = 'chat-message loading';
        loadingMsg.textContent = 'ü§ñ Analisando sua pergunta...';
        chatMessages.appendChild(loadingMsg);
        chatMessages.scrollTop = chatMessages.scrollHeight;
        
        try {
          // Call real API
          const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              user_message: message,
              history: getChatHistory()
            }),
          });
          
          if (!response.ok) {
            throw new Error(`Erro HTTP: ${response.status}`);
          }
          
          const data = await response.json();
          console.log('ü§ñ Resposta da API:', data);
          
          // Remove loading message
          loadingMsg.remove();
          
          // Add agent response
          const agentMsg = document.createElement('div');
          agentMsg.className = 'chat-message agent';
          
          // Format response with basic markdown support
          let responseText = data.answer || data.response || 'Desculpe, n√£o consegui processar sua mensagem.';
          responseText = formatResponse(responseText);
          agentMsg.innerHTML = responseText;
          
          chatMessages.appendChild(agentMsg);
          chatMessages.scrollTop = chatMessages.scrollHeight;
          
        } catch (error) {
          console.error('‚ùå Erro no chat:', error);
          
          // Remove loading message
          loadingMsg.remove();
          
          // Show error message
          const errorMsg = document.createElement('div');
          errorMsg.className = 'chat-message agent';
          errorMsg.innerHTML = '‚ùå <strong>Erro de conex√£o</strong><br>Verifique sua conex√£o e tente novamente.';
          chatMessages.appendChild(errorMsg);
          chatMessages.scrollTop = chatMessages.scrollHeight;
        }
      }
      
      // Get chat history for context
      function getChatHistory() {
        const messages = chatMessages?.querySelectorAll('.chat-message:not(.loading)') || [];
        const history = [];
        
        messages.forEach(msg => {
          if (msg.classList.contains('user')) {
            history.push({ role: 'user', content: msg.textContent });
          } else if (msg.classList.contains('agent')) {
            history.push({ role: 'assistant', content: msg.textContent });
          }
        });
        
        // Keep only last 10 messages for context
        return history.slice(-10);
      }
      
      // Format response with basic markdown support
      function formatResponse(text) {
        return text
          .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
          .replace(/\*(.*?)\*/g, '<em>$1</em>')
          .replace(/\n/g, '<br>')
          .replace(/‚Ä¢/g, '‚Ä¢')
          .replace(/üì±|üìä|üéØ|üìÖ|ü§ñ|‚úÖ|‚ùå|‚ö†Ô∏è|üí°|üî•|üìà|üìâ|üéâ/g, '<span style="font-size: 16px;">$&</span>');
      }
      
      // Clear chat function
      window.clearChat = function() {
        if (chatMessages) {
          chatMessages.innerHTML = `
            <div class="chat-message agent">
              ü§ñ <strong>Chat limpo!</strong> Sou o ORBION, seu assistente IA.
              <br><br>
              <strong>Posso ajudar com:</strong><br>
              üì± Gerenciamento de leads<br>
              üìä An√°lise de campanhas<br>
              üéØ Estrat√©gias de vendas<br>
              üìÖ Agendamentos<br>
              <br>
              Como posso ajud√°-lo?
            </div>
          `;
        }
        console.log('üßπ Chat limpo');
      };
      
      // Send suggestion function
      window.sendSuggestion = function(suggestion) {
        if (chatInput) {
          chatInput.value = suggestion;
          sendMessage();
        }
      };
      
      if (chatSend) {
        chatSend.addEventListener('click', sendMessage);
      }
      
      if (chatInput) {
        chatInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
            sendMessage();
          }
        });
      }
      
      // ===== FUN√á√ïES DE TESTE =====
      
      window.testarMobileNavegacao = function(tabName) {
        console.log('üß™ TESTE MANUAL:', tabName);
        return navigateToTab(tabName);
      };
      
      window.abrirDrawer = function() {
        console.log('üß™ TESTE: Abrir drawer');
        drawer.classList.add('active');
        drawerOverlay.classList.add('active');
      };
      
      window.fecharDrawer = function() {
        console.log('üß™ TESTE: Fechar drawer');
        drawer.classList.remove('active');
        drawerOverlay.classList.remove('active');
      };
      
      // ===== INICIALIZA√á√ÉO =====
      
      console.log('‚úÖ SISTEMA MOBILE CONFIGURADO!');
      console.log('üì± Total drawer items:', drawerItems.length);
      console.log('üì± Total nav items:', navItems.length);
      console.log('üì± Total tabs:', tabs.length);
      console.log('');
      console.log('üß™ TESTES DISPON√çVEIS:');
      console.log('- testarMobileNavegacao("home")');
      console.log('- abrirDrawer()');
      console.log('- fecharDrawer()');
      console.log('');
      
      // ===== WHATSAPP FUNCTIONALITY =====
      
      // WhatsApp data refresh
      async function refreshWhatsAppData() {
        console.log('üîÑ Atualizando dados WhatsApp...');
        
        try {
          // Check WhatsApp status
          const statusResponse = await fetch('/api/whatsapp/status');
          if (statusResponse.ok) {
            const statusData = await statusResponse.json();
            updateWhatsAppStatus(statusData);
          }
          
          // Load analytics
          const analyticsResponse = await fetch('/api/analytics/overview');
          if (analyticsResponse.ok) {
            const analyticsData = await analyticsResponse.json();
            updateWhatsAppStats(analyticsData);
          }
          
          // Load contacts
          await loadWhatsAppContacts();
          
        } catch (error) {
          console.error('‚ùå Erro ao atualizar WhatsApp:', error);
        }
      }
      
      function updateWhatsAppStatus(data) {
        const statusIndicator = document.getElementById('whatsapp-status');
        const statusText = document.getElementById('whatsapp-status-text');
        
        if (statusIndicator && statusText) {
          if (data.connected || data.status === 'connected') {
            statusIndicator.className = 'status-indicator active';
            statusText.textContent = 'WhatsApp - Conectado';
          } else {
            statusIndicator.className = 'status-indicator';
            statusText.textContent = 'WhatsApp - Desconectado';
          }
        }
      }
      
      function updateWhatsAppStats(data) {
        const messagesToday = document.getElementById('messages-today');
        const activeContacts = document.getElementById('active-contacts');
        const responseRate = document.getElementById('response-rate');
        
        if (messagesToday && data.whatsapp?.messages_today) {
          messagesToday.textContent = data.whatsapp.messages_today;
        }
        
        if (activeContacts && data.whatsapp?.active_contacts) {
          activeContacts.textContent = data.whatsapp.active_contacts;
        }
        
        if (responseRate && data.whatsapp?.response_rate) {
          responseRate.textContent = data.whatsapp.response_rate + '%';
        }
      }
      
      async function loadWhatsAppContacts() {
        const contactsList = document.getElementById('whatsapp-contacts');
        if (!contactsList) return;
        
        try {
          contactsList.innerHTML = '<div class="loading-state">Carregando contatos...</div>';
          
          const response = await fetch('/api/analytics/top-contacts');
          if (response.ok) {
            const contacts = await response.json();
            
            if (contacts.length === 0) {
              contactsList.innerHTML = '<div class="loading-state">Nenhum contato encontrado</div>';
              return;
            }
            
            const contactsHtml = contacts.slice(0, 5).map(contact => `
              <div class="contact-item">
                <div class="contact-info">
                  <div class="contact-name">${contact.name || contact.phone}</div>
                  <div class="contact-phone">${contact.phone}</div>
                </div>
                <div class="contact-count">${contact.message_count || 0} msgs</div>
              </div>
            `).join('');
            
            contactsList.innerHTML = contactsHtml;
          } else {
            contactsList.innerHTML = '<div class="loading-state">Erro ao carregar contatos</div>';
          }
        } catch (error) {
          console.error('‚ùå Erro ao carregar contatos:', error);
          contactsList.innerHTML = '<div class="loading-state">Erro de conex√£o</div>';
        }
      }
      
      // WhatsApp message sending
      window.sendWhatsAppMessage = async function() {
        const phone = document.getElementById('whatsapp-phone')?.value?.trim();
        const message = document.getElementById('whatsapp-message')?.value?.trim();
        
        if (!phone || !message) {
          alert('Por favor, preencha o n√∫mero e a mensagem.');
          return;
        }
        
        try {
          console.log('üì± Enviando WhatsApp para:', phone);
          
          const response = await fetch('/api/whatsapp/send', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ phone, message })
          });
          
          if (response.ok) {
            const result = await response.json();
            alert('‚úÖ Mensagem enviada com sucesso!');
            document.getElementById('whatsapp-message').value = '';
          } else {
            throw new Error('Erro no envio');
          }
        } catch (error) {
          console.error('‚ùå Erro ao enviar WhatsApp:', error);
          alert('‚ùå Erro ao enviar mensagem. Verifique a conex√£o.');
        }
      };
      
      // WhatsApp TTS message
      window.sendWhatsAppTTS = async function() {
        const phone = document.getElementById('whatsapp-phone')?.value?.trim();
        const message = document.getElementById('whatsapp-message')?.value?.trim();
        
        if (!phone || !message) {
          alert('Por favor, preencha o n√∫mero e a mensagem.');
          return;
        }
        
        try {
          console.log('üéµ Enviando WhatsApp TTS para:', phone);
          
          const response = await fetch('/api/whatsapp/send-tts', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ phone, message })
          });
          
          if (response.ok) {
            alert('‚úÖ √Åudio enviado com sucesso!');
            document.getElementById('whatsapp-message').value = '';
          } else {
            throw new Error('Erro no envio TTS');
          }
        } catch (error) {
          console.error('‚ùå Erro ao enviar TTS:', error);
          alert('‚ùå Erro ao enviar √°udio. Verifique a conex√£o.');
        }
      };
      
      // Intelligent campaign
      window.runIntelligentCampaign = async function() {
        if (!confirm('Executar campanha inteligente? Isso pode enviar mensagens para m√∫ltiplos leads.')) {
          return;
        }
        
        try {
          console.log('üß† Executando campanha inteligente...');
          
          const response = await fetch('/api/whatsapp/intelligent-campaign', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' }
          });
          
          if (response.ok) {
            const result = await response.json();
            alert(`‚úÖ Campanha executada! ${result.sent || 0} mensagens enviadas.`);
          } else {
            throw new Error('Erro na campanha');
          }
        } catch (error) {
          console.error('‚ùå Erro na campanha:', error);
          alert('‚ùå Erro ao executar campanha.');
        }
      };
      
      // Call random lead
      window.callRandomLead = async function() {
        try {
          console.log('üìû Ligando para lead aleat√≥rio...');
          
          const response = await fetch('/api/whatsapp/call-lead', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' }
          });
          
          if (response.ok) {
            const result = await response.json();
            alert(`‚úÖ Liga√ß√£o iniciada para ${result.lead?.name || 'lead'}!`);
          } else {
            throw new Error('Erro na liga√ß√£o');
          }
        } catch (error) {
          console.error('‚ùå Erro ao ligar:', error);
          alert('‚ùå Erro ao iniciar liga√ß√£o.');
        }
      };
      
      // Global refresh function
      window.refreshWhatsAppData = refreshWhatsAppData;
      
      // Load WhatsApp data on init
      setTimeout(() => {
        refreshWhatsAppData();
      }, 2000);
      
      // ===== ANALYTICS FUNCTIONALITY =====
      
      // Load analytics data
      async function loadAnalyticsData() {
        console.log('üìä Carregando dados de analytics...');
        
        const period = document.getElementById('analytics-period')?.value || '30d';
        
        try {
          const response = await fetch('/api/analytics/overview');
          if (response.ok) {
            const data = await response.json();
            updateAnalyticsDisplay(data);
            updateChannelsData(data);
            updateGoalsProgress(data);
            drawPerformanceChart(data);
          } else {
            console.error('Erro ao carregar analytics');
          }
        } catch (error) {
          console.error('‚ùå Erro ao carregar analytics:', error);
        }
      }
      
      function updateAnalyticsDisplay(data) {
        // Update main stats
        updateElement('total-leads', data.leads?.total || 0);
        updateElement('total-conversions', data.leads?.converted || 0);
        updateElement('conversion-rate', calculatePercentage(data.leads?.converted, data.leads?.total));
        updateElement('revenue', formatCurrency(data.revenue?.total || 0));
        
        // Update change indicators
        updateChangeIndicator('leads-change', data.leads?.change || 0);
        updateChangeIndicator('conversions-change', data.conversions?.change || 0);
        updateChangeIndicator('rate-change', data.conversion_rate?.change || 0);
        updateChangeIndicator('revenue-change', data.revenue?.change || 0);
      }
      
      function updateChannelsData(data) {
        const channels = data.channels || {};
        const total = (channels.whatsapp || 0) + (channels.email || 0) + (channels.calls || 0);
        
        updateElement('whatsapp-messages', channels.whatsapp || 0);
        updateElement('email-messages', channels.email || 0);
        updateElement('call-messages', channels.calls || 0);
        
        updateElement('whatsapp-percentage', calculatePercentage(channels.whatsapp, total));
        updateElement('email-percentage', calculatePercentage(channels.email, total));
        updateElement('call-percentage', calculatePercentage(channels.calls, total));
      }
      
      function updateGoalsProgress(data) {
        // Leads progress
        const leadsAchieved = data.leads?.total || 0;
        const leadsTarget = 200;
        const leadsProgress = Math.min((leadsAchieved / leadsTarget) * 100, 100);
        
        updateElement('leads-achieved', leadsAchieved);
        updateProgressBar('leads-progress', leadsProgress);
        
        // Conversions progress
        const conversionsAchieved = data.leads?.converted || 0;
        const conversionsTarget = 50;
        const conversionsProgress = Math.min((conversionsAchieved / conversionsTarget) * 100, 100);
        
        updateElement('conversions-achieved', conversionsAchieved);
        updateProgressBar('conversions-progress', conversionsProgress);
        
        // Revenue progress
        const revenueAchieved = (data.revenue?.total || 0) / 1000; // Convert to K
        const revenueTarget = 50;
        const revenueProgress = Math.min((revenueAchieved / revenueTarget) * 100, 100);
        
        updateElement('revenue-achieved', revenueAchieved.toFixed(0) + 'k');
        updateProgressBar('revenue-progress', revenueProgress);
      }
      
      function drawPerformanceChart(data) {
        const canvas = document.getElementById('performance-chart');
        if (!canvas) return;
        
        const ctx = canvas.getContext('2d');
        const width = canvas.width;
        const height = canvas.height;
        
        // Clear canvas
        ctx.clearRect(0, 0, width, height);
        
        // Mock data for chart
        const chartData = data.performance || [
          { month: 'Jan', leads: 45, conversions: 8 },
          { month: 'Fev', leads: 52, conversions: 12 },
          { month: 'Mar', leads: 67, conversions: 15 },
          { month: 'Abr', leads: 71, conversions: 18 },
          { month: 'Mai', leads: 89, conversions: 23 },
          { month: 'Jun', leads: 95, conversions: 25 }
        ];
        
        // Draw simple line chart
        const padding = 40;
        const chartWidth = width - (padding * 2);
        const chartHeight = height - (padding * 2);
        
        // Draw axes
        ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--border');
        ctx.beginPath();
        ctx.moveTo(padding, padding);
        ctx.lineTo(padding, height - padding);
        ctx.lineTo(width - padding, height - padding);
        ctx.stroke();
        
        // Draw leads line
        ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--primary-color');
        ctx.lineWidth = 2;
        ctx.beginPath();
        
        chartData.forEach((point, i) => {
          const x = padding + (i * (chartWidth / (chartData.length - 1)));
          const y = height - padding - ((point.leads / 100) * chartHeight);
          
          if (i === 0) {
            ctx.moveTo(x, y);
          } else {
            ctx.lineTo(x, y);
          }
        });
        ctx.stroke();
        
        // Draw conversions line
        ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--secondary-color');
        ctx.beginPath();
        
        chartData.forEach((point, i) => {
          const x = padding + (i * (chartWidth / (chartData.length - 1)));
          const y = height - padding - ((point.conversions / 30) * chartHeight);
          
          if (i === 0) {
            ctx.moveTo(x, y);
          } else {
            ctx.lineTo(x, y);
          }
        });
        ctx.stroke();
      }
      
      // Helper functions
      function updateElement(id, value) {
        const element = document.getElementById(id);
        if (element) {
          element.textContent = value;
        }
      }
      
      function updateChangeIndicator(id, change) {
        const element = document.getElementById(id);
        if (element && change !== undefined) {
          const sign = change > 0 ? '+' : '';
          element.textContent = `${sign}${change}%`;
          element.className = `stat-change ${change >= 0 ? 'positive' : 'negative'}`;
        }
      }
      
      function updateProgressBar(id, percentage) {
        const element = document.getElementById(id);
        if (element) {
          element.style.width = percentage + '%';
        }
      }
      
      function calculatePercentage(value, total) {
        if (!total || total === 0) return '0%';
        return Math.round((value / total) * 100) + '%';
      }
      
      function formatCurrency(value) {
        if (value >= 1000) {
          return 'R$ ' + (value / 1000).toFixed(0) + 'k';
        }
        return 'R$ ' + value.toFixed(0);
      }
      
      // Global function for period change
      window.loadAnalyticsData = loadAnalyticsData;
      
      // Load analytics on navigation
      setTimeout(() => {
        loadAnalyticsData();
      }, 3000);
      
      // ===== AGENT STATUS FUNCTIONALITY =====
      
      let systemStartTime = Date.now();
      let agentStatusInterval;
      let activityChart;
      
      // Initialize agent status monitoring
      function initializeAgentStatus() {
        console.log('ü§ñ Inicializando monitoramento do agente...');
        
        // Start real-time updates
        updateAgentStatus();
        agentStatusInterval = setInterval(updateAgentStatus, 3000);
        
        // Initialize activity chart
        setTimeout(() => {
          initActivityChart();
        }, 1000);
        
        // Initialize logs
        initSystemLogs();
      }
      
      // Update agent status with real-time data
      async function updateAgentStatus() {
        // Update uptime
        updateUptime();
        
        // Simulate performance metrics
        updatePerformanceMetrics();
        
        // Update service status
        await updateServicesStatus();
        
        // Update statistics
        updateStatistics();
        
        // Add random system log
        addRandomLog();
      }
      
      function updateUptime() {
        const now = Date.now();
        const uptimeMs = now - systemStartTime;
        const uptimeHours = Math.floor(uptimeMs / (1000 * 60 * 60));
        const uptimeMinutes = Math.floor((uptimeMs % (1000 * 60 * 60)) / (1000 * 60));
        
        const uptimeText = `${uptimeHours}h ${uptimeMinutes}m`;
        updateElement('uptime-counter', uptimeText);
        
        // Calculate availability (simulate high availability with occasional tiny drops)
        const availability = 99.8 + (Math.random() * 0.2);
        updateElement('uptime-percentage', availability.toFixed(1) + '%');
      }
      
      function updatePerformanceMetrics() {
        // CPU usage (simulate realistic values)
        const cpuUsage = Math.floor(Math.random() * 20 + 15); // 15-35%
        updateElement('cpu-value', cpuUsage + '%');
        updateProgressBar('cpu-fill', cpuUsage);
        
        // Memory usage (simulate realistic values)
        const memoryUsage = Math.floor(Math.random() * 15 + 45); // 45-60%
        updateElement('memory-value', memoryUsage + '%');
        updateProgressBar('memory-fill', memoryUsage);
        
        // Requests per minute
        const requests = Math.floor(Math.random() * 50 + 80); // 80-130 req/min
        updateElement('requests-value', requests);
        updateProgressBar('requests-fill', Math.min(requests / 2, 100)); // Scale for visual
      }
      
      async function updateServicesStatus() {
        // API Principal - always active
        updateServiceStatus('api-status', 'api-text', true, 'Ativo');
        
        // WhatsApp - check real status
        try {
          const response = await fetch('/api/whatsapp/status');
          const isActive = response.ok;
          updateServiceStatus('whatsapp-service-status', 'whatsapp-service-text', 
            isActive, isActive ? 'Conectado' : 'Desconectado');
        } catch {
          updateServiceStatus('whatsapp-service-status', 'whatsapp-service-text', false, 'Erro');
        }
        
        // Database - always operational (SQLite local)
        updateServiceStatus('db-status', 'db-text', true, 'Operacional');
        
        // OpenAI API - simulate mostly active
        const openaiActive = Math.random() > 0.1; // 90% uptime
        updateServiceStatus('openai-status', 'openai-text', 
          openaiActive, openaiActive ? 'Conectado' : 'Limite de Rate');
      }
      
      function updateServiceStatus(dotId, textId, isActive, text) {
        const dot = document.getElementById(dotId);
        const textEl = document.getElementById(textId);
        
        if (dot) {
          dot.className = isActive ? 'service-dot active' : 'service-dot';
        }
        if (textEl) {
          textEl.textContent = text;
          textEl.style.color = isActive ? 'var(--ok)' : 'var(--err)';
        }
      }
      
      function updateStatistics() {
        // Messages processed (incrementing)
        const currentMessages = parseInt(document.getElementById('messages-processed')?.textContent || '0');
        const newMessages = currentMessages + Math.floor(Math.random() * 3);
        updateElement('messages-processed', newMessages);
        updateElement('messages-change', '+' + Math.floor(Math.random() * 5 + 8) + ' hoje');
        
        // Response time (simulate good performance)
        const responseTime = (Math.random() * 800 + 200).toFixed(0); // 200-1000ms
        updateElement('response-time', responseTime + 'ms');
        updateElement('response-change', '-' + Math.floor(Math.random() * 100 + 50) + 'ms');
        
        // Active users
        const activeUsers = Math.floor(Math.random() * 10 + 25); // 25-35
        updateElement('active-users', activeUsers);
        updateElement('users-change', 'Online');
        
        // Errors (keep low)
        const errors = Math.random() > 0.95 ? 1 : 0; // Very occasional errors
        updateElement('errors-24h', errors);
      }
      
      function initActivityChart() {
        const canvas = document.getElementById('activity-chart');
        if (!canvas) return;
        
        const ctx = canvas.getContext('2d');
        const width = canvas.width;
        const height = canvas.height;
        
        // Data points for activity chart
        const dataPoints = Array(50).fill(0).map(() => Math.random() * 80 + 20);
        
        function drawActivityChart() {
          ctx.clearRect(0, 0, width, height);
          
          // Draw background grid
          ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--border');
          ctx.lineWidth = 0.5;
          
          // Vertical grid lines
          for (let i = 0; i < width; i += 30) {
            ctx.beginPath();
            ctx.moveTo(i, 0);
            ctx.lineTo(i, height);
            ctx.stroke();
          }
          
          // Horizontal grid lines
          for (let i = 0; i < height; i += 25) {
            ctx.beginPath();
            ctx.moveTo(0, i);
            ctx.lineTo(width, i);
            ctx.stroke();
          }
          
          // Draw activity line
          ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--primary-color');
          ctx.lineWidth = 2;
          ctx.beginPath();
          
          dataPoints.forEach((point, index) => {
            const x = (index / (dataPoints.length - 1)) * width;
            const y = height - ((point / 100) * height);
            
            if (index === 0) {
              ctx.moveTo(x, y);
            } else {
              ctx.lineTo(x, y);
            }
          });
          
          ctx.stroke();
          
          // Add new data point and shift array
          dataPoints.shift();
          dataPoints.push(Math.random() * 80 + 20);
        }
        
        // Update chart every 2 seconds
        drawActivityChart();
        setInterval(drawActivityChart, 2000);
      }
      
      function initSystemLogs() {
        const logs = [
          { type: 'success', message: 'Sistema iniciado com sucesso' },
          { type: 'info', message: 'Conectando com APIs externas...' },
          { type: 'success', message: 'OpenAI API conectada' },
          { type: 'success', message: 'WhatsApp Evolution API ativa' },
          { type: 'info', message: 'Banco de dados local carregado' }
        ];
        
        const container = document.getElementById('system-logs');
        if (container) {
          container.innerHTML = '';
          logs.forEach(log => addLogEntry(log.type, log.message));
        }
      }
      
      function addRandomLog() {
        if (Math.random() > 0.7) { // 30% chance of new log
          const logTypes = [
            { type: 'success', messages: ['Mensagem processada', 'Lead qualificado', 'Resposta enviada', 'Backup criado'] },
            { type: 'info', messages: ['Verificando conex√µes', 'Atualizando dados', 'Processando fila'] },
            { type: 'warning', messages: ['Rate limit pr√≥ximo', 'Mem√≥ria alta', 'Fila de mensagens cheia'] }
          ];
          
          const randomType = logTypes[Math.floor(Math.random() * logTypes.length)];
          const randomMessage = randomType.messages[Math.floor(Math.random() * randomType.messages.length)];
          
          addLogEntry(randomType.type, randomMessage);
        }
      }
      
      function addLogEntry(type, message) {
        const container = document.getElementById('system-logs');
        if (!container) return;
        
        const logEntry = document.createElement('div');
        logEntry.className = `log-entry ${type}`;
        
        const timestamp = new Date().toLocaleTimeString('pt-BR', {
          hour12: false,
          hour: '2-digit',
          minute: '2-digit',
          second: '2-digit'
        });
        
        logEntry.innerHTML = `
          <span class="log-timestamp">[${timestamp}]</span>
          <span class="log-message">${message}</span>
        `;
        
        // Add to top of logs
        container.insertBefore(logEntry, container.firstChild);
        
        // Keep only last 20 logs
        const logs = container.querySelectorAll('.log-entry');
        if (logs.length > 20) {
          container.removeChild(logs[logs.length - 1]);
        }
      }
      
      // Clear logs function
      window.clearLogs = function() {
        const container = document.getElementById('system-logs');
        if (container) {
          container.innerHTML = '<div class="loading-state">Logs limpos</div>';
          setTimeout(() => {
            initSystemLogs();
          }, 1000);
        }
      };
      
      // Start monitoring when navigating to stats tab
      setTimeout(() => {
        initializeAgentStatus();
      }, 4000);
      
      // ===== THEME CUSTOMIZATION FUNCTIONALITY =====
      
      const themePresets = {
        default: {
          primary: '#667eea',
          secondary: '#764ba2', 
          accent: '#4facfe'
        },
        ocean: {
          primary: '#0891b2',
          secondary: '#0e7490',
          accent: '#06b6d4'
        },
        forest: {
          primary: '#059669',
          secondary: '#047857',
          accent: '#10b981'
        },
        sunset: {
          primary: '#ea580c',
          secondary: '#dc2626',
          accent: '#f97316'
        },
        purple: {
          primary: '#7c3aed',
          secondary: '#5b21b6',
          accent: '#8b5cf6'
        },
        dark: {
          primary: '#374151',
          secondary: '#1f2937',
          accent: '#6b7280'
        }
      };
      
      let currentSettings = {
        primary: '#667eea',
        secondary: '#764ba2',
        accent: '#4facfe',
        companyName: 'ORBION',
        autoRefresh: true,
        animations: true,
        soundAlerts: false
      };
      
      // Initialize theme system
      function initializeTheme() {
        console.log('üé® Inicializando sistema de temas...');
        
        // Load saved settings
        loadSettings();
        
        // Initialize theme mode
        initializeThemeMode();
        
        // Apply current theme
        applyCurrentTheme();
        
        // Update UI controls
        updateThemeControls();
      }
      
      // Load settings from localStorage
      function loadSettings() {
        const saved = localStorage.getItem('orbion-settings');
        if (saved) {
          try {
            currentSettings = { ...currentSettings, ...JSON.parse(saved) };
            console.log('‚öôÔ∏è Configura√ß√µes carregadas:', currentSettings);
          } catch (error) {
            console.warn('‚ö†Ô∏è Erro ao carregar configura√ß√µes:', error);
          }
        }
      }
      
      // Save settings to localStorage
      function saveSettings() {
        localStorage.setItem('orbion-settings', JSON.stringify(currentSettings));
        updateElement('last-updated', new Date().toLocaleTimeString('pt-BR'));
        console.log('üíæ Configura√ß√µes salvas');
      }
      
      // Theme modes configuration
      const themeConfigs = {
        light: {
          '--custom-bg-0': '#ffffff',
          '--custom-bg-1': '#f8fafc',
          '--custom-bg-2': '#f1f5f9',
          '--custom-bg-3': '#e2e8f0',
          '--custom-text-0': '#0f172a',
          '--custom-text-1': '#1e293b',
          '--custom-text-2': '#475569',
          '--custom-text-3': '#64748b',
          '--custom-border': '#e2e8f0',
          '--custom-shadow': 'rgba(0, 0, 0, 0.1)'
        },
        dark: {
          '--custom-bg-0': '#0f172a',
          '--custom-bg-1': '#1e293b',
          '--custom-bg-2': '#334155',
          '--custom-bg-3': '#475569',
          '--custom-text-0': '#f1f5f9',
          '--custom-text-1': '#e2e8f0',
          '--custom-text-2': '#cbd5e1',
          '--custom-text-3': '#94a3b8',
          '--custom-border': '#475569',
          '--custom-shadow': 'rgba(0, 0, 0, 0.4)'
        },
        glass: {
          '--custom-bg-0': 'rgba(255, 255, 255, 0.1)',
          '--custom-bg-1': 'rgba(255, 255, 255, 0.05)',
          '--custom-bg-2': 'rgba(255, 255, 255, 0.15)',
          '--custom-bg-3': 'rgba(255, 255, 255, 0.2)',
          '--custom-text-0': '#ffffff',
          '--custom-text-1': '#f8fafc',
          '--custom-text-2': '#e2e8f0',
          '--custom-text-3': '#cbd5e1',
          '--custom-border': 'rgba(255, 255, 255, 0.2)',
          '--custom-shadow': 'rgba(0, 0, 0, 0.2)'
        },
        neon: {
          '--custom-bg-0': '#0a0a0f',
          '--custom-bg-1': '#111121',
          '--custom-bg-2': '#1a1a2e',
          '--custom-bg-3': '#16213e',
          '--custom-text-0': '#00ffff',
          '--custom-text-1': '#00e6e6',
          '--custom-text-2': '#00cccc',
          '--custom-text-3': '#009999',
          '--custom-border': '#00ffff',
          '--custom-shadow': 'rgba(0, 255, 255, 0.3)'
        },
        minimal: {
          '--custom-bg-0': '#ffffff',
          '--custom-bg-1': '#fafafa',
          '--custom-bg-2': '#f5f5f5',
          '--custom-bg-3': '#eeeeee',
          '--custom-text-0': '#212121',
          '--custom-text-1': '#424242',
          '--custom-text-2': '#757575',
          '--custom-text-3': '#9e9e9e',
          '--custom-border': '#e0e0e0',
          '--custom-shadow': 'rgba(0, 0, 0, 0.08)'
        },
        contrast: {
          '--custom-bg-0': '#000000',
          '--custom-bg-1': '#1a1a1a',
          '--custom-bg-2': '#333333',
          '--custom-bg-3': '#4d4d4d',
          '--custom-text-0': '#ffffff',
          '--custom-text-1': '#ffffff',
          '--custom-text-2': '#ffffff',
          '--custom-text-3': '#cccccc',
          '--custom-border': '#ffffff',
          '--custom-shadow': 'rgba(255, 255, 255, 0.2)'
        }
      };
      
      // Initialize theme mode
      function initializeThemeMode() {
        if (!currentSettings.themeMode) {
          currentSettings.themeMode = 'light';
          saveSettings();
        }
        applyThemeMode(currentSettings.themeMode);
      }
      
      // Apply theme mode
      function applyThemeMode(mode) {
        console.log('üåô Aplicando modo de tema:', mode);
        
        const root = document.documentElement;
        const config = themeConfigs[mode] || themeConfigs.light;
        
        // Apply base theme config
        Object.entries(config).forEach(([property, value]) => {
          root.style.setProperty(property, value);
        });
        
        // Set theme mode attribute
        document.documentElement.setAttribute('data-theme', mode);
        
        // Apply custom colors on top of base theme
        applyCurrentTheme();
        
        console.log('‚úÖ Modo de tema aplicado:', mode);
      }
      
      // Switch theme mode
      window.switchThemeMode = function(mode) {
        console.log('üîÑ Mudando para modo:', mode);
        currentSettings.themeMode = mode;
        saveSettings();
        applyThemeMode(mode);
        updateThemeModeControls();
      };
      
      // Update theme mode controls
      function updateThemeModeControls() {
        const currentMode = currentSettings.themeMode || 'light';
        
        // Update radio buttons
        const modeRadios = document.querySelectorAll('input[name="theme-mode"]');
        modeRadios.forEach(radio => {
          radio.checked = radio.value === currentMode;
        });
        
        // Update mode indicator
        const modeIndicator = document.getElementById('current-theme-mode');
        if (modeIndicator) {
          const modeNames = {
            light: '‚òÄÔ∏è Claro',
            dark: 'üåô Escuro',
            glass: 'üíé Glass',
            neon: '‚ö° Neon',
            minimal: '‚ö™ Minimal',
            contrast: '‚ö´ Alto Contraste'
          };
          modeIndicator.textContent = modeNames[currentMode] || modeNames.light;
        }
      }
      
      // Apply current theme to CSS variables
      function applyCurrentTheme() {
        const root = document.documentElement;
        
        // Aplicar as cores customizadas diretamente √†s vari√°veis principais
        root.style.setProperty('--primary-color', currentSettings.primary);
        root.style.setProperty('--secondary-color', currentSettings.secondary);
        root.style.setProperty('--accent-color', currentSettings.accent);
        
        // Tamb√©m aplicar √†s vari√°veis customizadas (para compatibilidade)
        root.style.setProperty('--custom-primary', currentSettings.primary);
        root.style.setProperty('--custom-secondary', currentSettings.secondary);
        root.style.setProperty('--custom-accent', currentSettings.accent);
        
        console.log('üé® Tema aplicado:', currentSettings);
        
        // For√ßar repaint
        document.body.style.display = 'none';
        document.body.offsetHeight; // trigger reflow
        document.body.style.display = '';
      }
      
      // Update theme control values
      function updateThemeControls() {
        // Update color inputs
        const primaryColorEl = document.getElementById('primary-color');
        const primaryTextEl = document.getElementById('primary-text');
        const secondaryColorEl = document.getElementById('secondary-color');
        const secondaryTextEl = document.getElementById('secondary-text');
        const accentColorEl = document.getElementById('accent-color');
        const accentTextEl = document.getElementById('accent-text');
        const companyNameEl = document.getElementById('company-name');
        
        if (primaryColorEl) primaryColorEl.value = currentSettings.primary;
        if (primaryTextEl) primaryTextEl.value = currentSettings.primary;
        if (secondaryColorEl) secondaryColorEl.value = currentSettings.secondary;
        if (secondaryTextEl) secondaryTextEl.value = currentSettings.secondary;
        if (accentColorEl) accentColorEl.value = currentSettings.accent;
        if (accentTextEl) accentTextEl.value = currentSettings.accent;
        if (companyNameEl) companyNameEl.value = currentSettings.companyName;
        
        // Update checkboxes
        const autoRefreshEl = document.getElementById('auto-refresh');
        const animationsEl = document.getElementById('animations');
        const soundAlertsEl = document.getElementById('sound-alerts');
        
        if (autoRefreshEl) autoRefreshEl.checked = currentSettings.autoRefresh;
        if (animationsEl) animationsEl.checked = currentSettings.animations;
        if (soundAlertsEl) soundAlertsEl.checked = currentSettings.soundAlerts;
        
        // Update theme mode controls
        updateThemeModeControls();
      }
      
      // Update theme when color picker changes
      window.updateTheme = function() {
        console.log('üé® Atualizando tema via color picker...');
        
        const primaryColor = document.getElementById('primary-color');
        const secondaryColor = document.getElementById('secondary-color');
        const accentColor = document.getElementById('accent-color');
        
        if (primaryColor) {
          currentSettings.primary = primaryColor.value;
          console.log('Primary color changed to:', primaryColor.value);
        }
        if (secondaryColor) {
          currentSettings.secondary = secondaryColor.value;
          console.log('Secondary color changed to:', secondaryColor.value);
        }
        if (accentColor) {
          currentSettings.accent = accentColor.value;
          console.log('Accent color changed to:', accentColor.value);
        }
        
        // Sync text inputs
        const primaryText = document.getElementById('primary-text');
        const secondaryText = document.getElementById('secondary-text');
        const accentText = document.getElementById('accent-text');
        
        if (primaryText) primaryText.value = currentSettings.primary;
        if (secondaryText) secondaryText.value = currentSettings.secondary;
        if (accentText) accentText.value = currentSettings.accent;
        
        applyCurrentTheme();
        saveSettings();
      };
      
      // Update theme when text input changes
      window.updateThemeFromText = function() {
        const primaryText = document.getElementById('primary-text')?.value;
        const secondaryText = document.getElementById('secondary-text')?.value;
        const accentText = document.getElementById('accent-text')?.value;
        
        if (isValidColor(primaryText)) {
          currentSettings.primary = primaryText;
          updateElement('primary-color', primaryText);
        }
        
        if (isValidColor(secondaryText)) {
          currentSettings.secondary = secondaryText;
          updateElement('secondary-color', secondaryText);
        }
        
        if (isValidColor(accentText)) {
          currentSettings.accent = accentText;
          updateElement('accent-color', accentText);
        }
        
        applyCurrentTheme();
        saveSettings();
      };
      
      // Apply preset theme
      window.applyPreset = function(presetName) {
        console.log('üé® Aplicando preset:', presetName);
        
        const preset = themePresets[presetName];
        if (!preset) {
          console.error('Preset n√£o encontrado:', presetName);
          return;
        }
        
        console.log('Preset encontrado:', preset);
        
        // Atualizar configura√ß√µes
        currentSettings.primary = preset.primary;
        currentSettings.secondary = preset.secondary;
        currentSettings.accent = preset.accent;
        
        console.log('Configura√ß√µes atualizadas:', currentSettings);
        
        // Aplicar tema imediatamente
        applyCurrentTheme();
        
        // Atualizar controles da interface
        updateThemeControls();
        
        // Salvar configura√ß√µes
        saveSettings();
        
        // Visual feedback
        const presetBtns = document.querySelectorAll('.preset-btn');
        presetBtns.forEach(btn => {
          btn.style.transform = 'scale(1)';
          btn.style.boxShadow = 'none';
        });
        
        if (event && event.currentTarget) {
          const clickedBtn = event.currentTarget;
          clickedBtn.style.transform = 'scale(0.95)';
          clickedBtn.style.boxShadow = '0 0 0 2px var(--primary-color)';
          
          setTimeout(() => {
            clickedBtn.style.transform = 'scale(1)';
            clickedBtn.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';
          }, 150);
        }
        
        console.log('‚úÖ Preset aplicado com sucesso!');
      };
      
      // Reset to defaults
      window.resetToDefaults = function() {
        if (!confirm('Resetar todas as configura√ß√µes para os valores padr√£o?')) {
          return;
        }
        
        currentSettings = {
          primary: '#667eea',
          secondary: '#764ba2',
          accent: '#4facfe',
          companyName: 'ORBION',
          autoRefresh: true,
          animations: true,
          soundAlerts: false
        };
        
        applyCurrentTheme();
        updateThemeControls();
        saveSettings();
        
        alert('‚úÖ Configura√ß√µes resetadas para os valores padr√£o!');
      };
      
      // Update company name
      window.updateCompanyName = function() {
        const nameInput = document.getElementById('company-name');
        if (nameInput) {
          currentSettings.companyName = nameInput.value || 'ORBION';
          saveSettings();
        }
      };
      
      // Toggle settings
      window.toggleAutoRefresh = function() {
        const checkbox = document.getElementById('auto-refresh');
        currentSettings.autoRefresh = checkbox ? checkbox.checked : true;
        saveSettings();
      };
      
      window.toggleAnimations = function() {
        const checkbox = document.getElementById('animations');
        currentSettings.animations = checkbox ? checkbox.checked : true;
        
        // Apply/remove animations
        const root = document.documentElement;
        if (currentSettings.animations) {
          root.style.removeProperty('--animation-duration');
        } else {
          root.style.setProperty('--animation-duration', '0s');
        }
        
        saveSettings();
      };
      
      window.toggleSoundAlerts = function() {
        const checkbox = document.getElementById('sound-alerts');
        currentSettings.soundAlerts = checkbox ? checkbox.checked : false;
        saveSettings();
      };
      
      // Export settings
      window.exportSettings = function() {
        const dataStr = JSON.stringify(currentSettings, null, 2);
        const dataBlob = new Blob([dataStr], { type: 'application/json' });
        
        const link = document.createElement('a');
        link.href = URL.createObjectURL(dataBlob);
        link.download = `orbion-settings-${new Date().toISOString().split('T')[0]}.json`;
        link.click();
        
        console.log('üì§ Configura√ß√µes exportadas');
      };
      
      // Import settings
      window.importSettings = function() {
        const fileInput = document.getElementById('import-settings');
        const file = fileInput?.files?.[0];
        
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = function(e) {
          try {
            const importedSettings = JSON.parse(e.target.result);
            
            // Validate and merge settings
            currentSettings = { ...currentSettings, ...importedSettings };
            
            applyCurrentTheme();
            updateThemeControls();
            saveSettings();
            
            alert('‚úÖ Configura√ß√µes importadas com sucesso!');
            console.log('üì• Configura√ß√µes importadas:', currentSettings);
            
          } catch (error) {
            alert('‚ùå Erro ao importar configura√ß√µes: Arquivo inv√°lido');
            console.error('Erro na importa√ß√£o:', error);
          }
        };
        
        reader.readAsText(file);
        fileInput.value = ''; // Reset input
      };
      
      // Helper function to validate color
      function isValidColor(color) {
        const colorRegex = /^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/;
        return colorRegex.test(color);
      }
      
      // Test theme colors function
      window.testThemeColors = function() {
        console.log('üß™ Testando aplica√ß√£o das cores...');
        
        const root = document.documentElement;
        const computedStyles = getComputedStyle(root);
        
        const primaryColor = computedStyles.getPropertyValue('--primary-color').trim();
        const secondaryColor = computedStyles.getPropertyValue('--secondary-color').trim();
        const accentColor = computedStyles.getPropertyValue('--accent-color').trim();
        
        console.log('Cores CSS atuais:');
        console.log('- Primary:', primaryColor);
        console.log('- Secondary:', secondaryColor);
        console.log('- Accent:', accentColor);
        
        console.log('Cores salvas nas configura√ß√µes:');
        console.log('- Primary:', currentSettings.primary);
        console.log('- Secondary:', currentSettings.secondary);
        console.log('- Accent:', currentSettings.accent);
        
        const testResult = document.getElementById('theme-test-result');
        if (testResult) {
          testResult.innerHTML = `
            <strong>Teste de Cores:</strong><br>
            Primary: ${primaryColor || currentSettings.primary}<br>
            Secondary: ${secondaryColor || currentSettings.secondary}<br>
            Accent: ${accentColor || currentSettings.accent}<br>
            <small>Verifique o console para mais detalhes</small>
          `;
        }
        
        // For√ßar re-aplica√ß√£o das cores
        applyCurrentTheme();
        
        // Testar uma mudan√ßa dr√°stica tempor√°ria para verificar se funciona
        setTimeout(() => {
          console.log('üé® Testando mudan√ßa tempor√°ria para vermelho...');
          root.style.setProperty('--primary-color', '#ff0000');
          root.style.setProperty('--secondary-color', '#cc0000');
          root.style.setProperty('--accent-color', '#ff3333');
          
          setTimeout(() => {
            console.log('üé® Revertendo para cores originais...');
            applyCurrentTheme();
          }, 2000);
        }, 1000);
      };
      
      // Initialize theme system
      setTimeout(() => {
        initializeTheme();
      }, 1000);
      
      // ===== INITIALIZATION =====
      
      // Ativar primeira aba por padr√£o
      navigateToTab('chat');
    });
    
    console.log('üöÄ Script mobile carregado - aguardando DOM...');
  </script>
</body>
</html>